// Do not edit this file; automatically generated by build.py.
"use strict";
(function(){var c=this,d=c.Blockly={};d.pathToBlockly="./";d.SVG_NS="http://www.w3.org/2000/svg";d.HTML_NS="http://www.w3.org/1999/xhtml";d.HSV_SATURATION=0.45;d.HSV_VALUE=0.65;d.makeColour=function(c){var c=c%360,f=d.HSV_VALUE,g=d.HSV_VALUE*(1-d.HSV_SATURATION),h=(f-g)*(c%60/60)+g,i=(f-g)*(1-c%60/60)+g,k;0<=c&&60>c?(c=f,k=h,f=g):60<=c&&120>c?(c=i,k=f,f=g):120<=c&&180>c?(c=g,k=f,f=h):180<=c&&240>c?(c=g,k=i):240<=c&&300>c?(c=h,k=g):300<=c&&360>c?(c=f,k=g,f=i):f=k=c=0;c=Math.floor(16*c);k=Math.floor(16*
k);f=Math.floor(16*f);return"#"+"0123456789abcdef".charAt(c)+"0123456789abcdef".charAt(k)+"0123456789abcdef".charAt(f)};d.INPUT_VALUE=1;d.OUTPUT_VALUE=2;d.NEXT_STATEMENT=3;d.PREVIOUS_STATEMENT=4;d.DUMMY_INPUT=5;d.ALIGN_LEFT=-1;d.ALIGN_CENTRE=0;d.ALIGN_RIGHT=1;d.OPPOSITE_TYPE=[];d.OPPOSITE_TYPE[d.INPUT_VALUE]=d.OUTPUT_VALUE;d.OPPOSITE_TYPE[d.OUTPUT_VALUE]=d.INPUT_VALUE;d.OPPOSITE_TYPE[d.NEXT_STATEMENT]=d.PREVIOUS_STATEMENT;d.OPPOSITE_TYPE[d.PREVIOUS_STATEMENT]=d.NEXT_STATEMENT;d.SOUNDS_={};d.selected=
null;d.editable=!0;d.highlightedConnection_=null;d.localConnection_=null;d.DRAG_RADIUS=5;d.SNAP_RADIUS=12;d.BUMP_DELAY=250;d.svgDoc=null;d.mainWorkspace=null;d.clipboard_=null;d.svgSize=function(){return{width:d.svg.cachedWidth_,height:d.svg.cachedHeight_,top:d.svg.cachedTop_,left:d.svg.cachedLeft_}};d.svgResize=function(){var c=d.svg.parentNode.offsetWidth,f=d.svg.parentNode.offsetHeight;d.svg.cachedWidth_!=c&&(d.svg.setAttribute("width",c+"px"),d.svg.cachedWidth_=c);d.svg.cachedHeight_!=f&&(d.svg.setAttribute("height",
f+"px"),d.svg.cachedHeight_=f);c=d.svg.getBoundingClientRect();d.svg.cachedLeft_=c.left;d.svg.cachedTop_=c.top};d.onMouseDown_=function(c){d.Block.terminateDrag_();d.hideChaff();if(!(d.isTargetInput_(c)||d.Mutator&&d.Mutator.isOpen))if(d.selected&&"svg"==c.target.nodeName&&d.selected.unselect(),d.isRightButton(c))d.ContextMenu&&d.showContextMenu_(c.clientX,c.clientY);else if("svg"==c.target.nodeName||!d.editable)d.mainWorkspace.dragMode=!0,d.mainWorkspace.startDragMouseX=c.clientX,d.mainWorkspace.startDragMouseY=
c.clientY,d.mainWorkspace.startDragMetrics=d.getMainWorkspaceMetrics(),d.mainWorkspace.startScrollX=d.mainWorkspace.scrollX,d.mainWorkspace.startScrollY=d.mainWorkspace.scrollY};d.onMouseUp_=function(){d.setCursorHand_(!1);d.mainWorkspace.dragMode=!1};d.onMouseMove_=function(c){if(d.mainWorkspace.dragMode){d.removeAllRanges();var f=d.mainWorkspace.startDragMetrics,g=d.mainWorkspace.startScrollX+(c.clientX-d.mainWorkspace.startDragMouseX),c=d.mainWorkspace.startScrollY+(c.clientY-d.mainWorkspace.startDragMouseY),
g=Math.min(g,-f.contentLeft),c=Math.min(c,-f.contentTop),g=Math.max(g,f.viewWidth-f.contentLeft-f.contentWidth),c=Math.max(c,f.viewHeight-f.contentTop-f.contentHeight);d.mainWorkspace.scrollbar.set(-g-f.contentLeft,-c-f.contentTop)}};d.onKeyDown_=function(c){if(!d.isTargetInput_(c))if(27==c.keyCode)d.hideChaff(),d.Mutator&&d.Mutator.isOpen&&d.Mutator.closeDialog();else if(8==c.keyCode||46==c.keyCode){if(d.selected&&d.selected.editable&&(!d.Mutator||!d.Mutator.isOpen))d.hideChaff(),d.selected.destroy(!0,
!0);c.preventDefault()}else if(c.altKey||c.ctrlKey||c.metaKey)d.selected&&(d.selected.editable&&d.selected.workspace==d.mainWorkspace)&&(d.hideChaff(),67==c.keyCode?d.copy_(d.selected):88==c.keyCode&&(d.copy_(d.selected),d.selected.destroy(!0,!0))),86==c.keyCode&&d.clipboard_&&d.mainWorkspace.paste(d.clipboard_)};d.copy_=function(c){var f=d.Xml.blockToDom_(c);d.Xml.deleteNext(f);c=c.getRelativeToSurfaceXY();f.setAttribute("x",d.RTL?-c.x:c.x);f.setAttribute("y",c.y);d.clipboard_=f};d.showContextMenu_=
function(c,f){var g=[],h={enabled:!1};h.text=d.MSG_HELP;h.callback=function(){};g.push(h);d.ContextMenu.show(c,f,g)};d.onContextMenu_=function(c){!d.isTargetInput_(c)&&d.ContextMenu&&c.preventDefault()};d.hideChaff=function(c){d.Tooltip&&d.Tooltip.hide();d.ContextMenu&&d.ContextMenu.hide();d.FieldDropdown.hideMenu();d.Toolbox&&(!c&&d.Toolbox.flyout_.autoClose)&&d.Toolbox.clearSelection()};d.removeAllRanges=function(){if(c.getSelection){var d=c.getSelection();d&&d.removeAllRanges&&(d.removeAllRanges(),
c.setTimeout(function(){c.getSelection().removeAllRanges()},0))}};d.isTargetInput_=function(c){return"textarea"==c.target.type||"text"==c.target.type};d.loadAudio_=function(c){if(Audio){var f=new Audio(d.pathToBlockly+"media/"+c+".wav");f&&f.play&&(f.play(),f.pause(),d.SOUNDS_[c]=f)}};d.playAudio=function(c){(c=d.SOUNDS_[c])&&c.play()};d.setCursorHand_=function(c){if(d.editable){var f="";c&&(f="url("+d.pathToBlockly+"media/handclosed.cur) 7 3, auto");d.selected&&(d.selected.getSvgRoot().style.cursor=
f);d.svgDoc.getElementsByTagName("svg")[0].style.cursor=f}};d.getMainWorkspaceMetrics=function(){var c=d.svgSize();d.Toolbox&&(c.width-=d.Toolbox.width);var f=c.width-d.Scrollbar.scrollbarThickness,g=c.height-d.Scrollbar.scrollbarThickness;try{var h=d.mainWorkspace.getCanvas().getBBox()}catch(i){return null}-Infinity==h.width&&-Infinity==h.height&&(h={width:0,height:0,x:0,y:0});var k=Math.min(h.x-f/2,h.x+h.width-f),f=Math.max(h.x+h.width+f/2,h.x+f),j=Math.min(h.y-g/2,h.y+h.height-g),g=Math.max(h.y+
h.height+g/2,h.y+g),h=0;d.Toolbox&&!d.RTL&&(h=d.Toolbox.width);return{viewHeight:c.height,viewWidth:c.width,contentHeight:g-j,contentWidth:f-k,viewTop:-d.mainWorkspace.scrollY,viewLeft:-d.mainWorkspace.scrollX,contentTop:j,contentLeft:k,absoluteTop:0,absoluteLeft:h}};d.setMainWorkspaceMetrics=function(c){var f=d.getMainWorkspaceMetrics();"number"==typeof c.x&&(d.mainWorkspace.scrollX=-f.contentWidth*c.x-f.contentLeft);"number"==typeof c.y&&(d.mainWorkspace.scrollY=-f.contentHeight*c.y-f.contentTop);
c="translate("+(d.mainWorkspace.scrollX+f.absoluteLeft)+","+(d.mainWorkspace.scrollY+f.absoluteTop)+")";d.mainWorkspace.getCanvas().setAttribute("transform",c);d.mainWorkspace.getBubbleCanvas().setAttribute("transform",c)};d.cssLoaded=function(){d.Toolbox&&d.Toolbox.redraw()}}).call(this);(function(c){c.Block=function(d,e){this.id=c.uniqueId();this.previousConnection=this.nextConnection=this.outputConnection=null;this.inputList=[];this.disabled=this.collapsed=this.rendered=this.inputsInline=!1;this.editable=d.editable;this.tooltip="";this.contextMenu=!0;this.parentBlock_=null;this.childBlocks_=[];this.isInFlyout=!1;this.workspace=d;d.addTopBlock(this);if(e){this.type=e;var f=c.Language[e];if(!f)throw'Error: "'+e+'" is an unknown language block.';for(var g in f)this[g]=f[g]}"function"==
typeof this.init&&this.init();this.editable&&"function"==typeof this.onchange&&c.bindEvent_(d.getCanvas(),"blocklyWorkspaceChange",this,this.onchange)};c.Block.prototype.svg_=null;c.Block.prototype.mutator=null;c.Block.prototype.comment=null;c.Block.prototype.warning=null;c.Block.prototype.initSvg=function(){this.svg_=new c.BlockSvg(this);this.svg_.init();c.bindEvent_(this.svg_.getRootNode(),"mousedown",this,this.onMouseDown_);this.workspace.getCanvas().appendChild(this.svg_.getRootNode())};c.Block.prototype.getSvgRoot=
function(){return this.svg_&&this.svg_.getRootNode()};c.Block.dragMode_=0;c.Block.onMouseUpWrapper_=null;c.Block.onMouseMoveWrapper_=null;c.Block.terminateDrag_=function(){c.Block.onMouseUpWrapper_&&(c.unbindEvent_(c.Block.onMouseUpWrapper_),c.Block.onMouseUpWrapper_=null);c.Block.onMouseMoveWrapper_&&(c.unbindEvent_(c.Block.onMouseMoveWrapper_),c.Block.onMouseMoveWrapper_=null);if(2==c.Block.dragMode_&&c.selected){var d=c.selected,e=d.getRelativeToSurfaceXY();d.moveConnections_(e.x-d.startDragX,
e.y-d.startDragY);delete d.draggedBubbles_;d.setDragging_(!1);d.render();window.setTimeout(function(){d.bumpNeighbours_()},c.BUMP_DELAY);c.fireUiEvent(window,"resize");d.workspace.fireChangeEvent()}c.Block.dragMode_=0};c.Block.prototype.select=function(){c.selected&&c.selected.unselect();c.selected=this;this.svg_.addSelect();c.fireUiEvent(this.workspace.getCanvas(),"blocklySelectChange")};c.Block.prototype.unselect=function(){c.selected=null;this.svg_.removeSelect();c.fireUiEvent(this.workspace.getCanvas(),
"blocklySelectChange")};c.Block.prototype.destroy=function(d,e){if(this.outputConnection)this.setParent(null);else{var f=null;this.previousConnection&&this.previousConnection.targetConnection&&(f=this.previousConnection.targetConnection,this.setParent(null));if(d&&this.nextConnection&&this.nextConnection.targetConnection){var g=this.nextConnection.targetConnection,h=this.nextConnection.targetBlock();this.nextConnection.disconnect();h.setParent(null);f&&f.connect(g)}}e&&this.svg_&&this.svg_.destroyUiEffect();
this.workspace.removeTopBlock(this);this.workspace=null;this.rendered=!1;c.selected==this&&(c.selected=null,c.Block.terminateDrag_());for(f=this.childBlocks_.length-1;0<=f;f--)this.childBlocks_[f].destroy(!1);this.mutator&&this.mutator.destroy();this.comment&&this.comment.destroy();this.warning&&this.warning.destroy();for(f=0;g=this.inputList[f];f++)g.destroy();this.inputList=[];g=this.getConnections_(!0);for(f=0;f<g.length;f++)h=g[f],h.targetConnection&&h.disconnect(),g[f].destroy();this.svg_&&(this.svg_.destroy(),
this.svg_=null)};c.Block.prototype.getRelativeToSurfaceXY=function(){var d=0,e=0;if(this.svg_){var f=this.svg_.getRootNode();do var g=c.getRelativeXY_(f),d=d+g.x,e=e+g.y,f=f.parentNode;while(f&&f!=this.workspace.getCanvas())}return{x:d,y:e}};c.Block.prototype.moveBy=function(c,e){var f=this.getRelativeToSurfaceXY();this.svg_.getRootNode().setAttribute("transform","translate("+(f.x+c)+", "+(f.y+e)+")");this.moveConnections_(c,e)};c.Block.prototype.onMouseDown_=function(d){c.svgResize();c.Block.terminateDrag_();
this.select();c.hideChaff(this.isInFlyout);if(c.isRightButton(d))c.ContextMenu&&this.showContextMenu_(d.clientX,d.clientY);else if(this.editable){c.removeAllRanges();c.setCursorHand_(!0);var e=this.getRelativeToSurfaceXY();this.startDragX=e.x;this.startDragY=e.y;this.startDragMouseX=d.clientX;this.startDragMouseY=d.clientY;c.Block.dragMode_=1;c.Block.onMouseUpWrapper_=c.bindEvent_(c.svgDoc,"mouseup",this,this.onMouseUp_);c.Block.onMouseMoveWrapper_=c.bindEvent_(c.svgDoc,"mousemove",this,this.onMouseMove_);
this.draggedBubbles_=[];for(var e=this.getDescendants(),f=0,g;g=e[f];f++){if(g.mutator){var h=g.mutator.getIconLocation();h.bubble=g.mutator;this.draggedBubbles_.push(h)}g.comment&&(h=g.comment.getIconLocation(),h.bubble=g.comment,this.draggedBubbles_.push(h));g.warning&&(h=g.warning.getIconLocation(),h.bubble=g.warning,this.draggedBubbles_.push(h))}}else return;d.stopPropagation()};c.Block.prototype.onMouseUp_=function(){c.Block.terminateDrag_();if(c.selected&&c.highlightedConnection_)c.localConnection_.connect(c.highlightedConnection_),
this.svg_&&(c.localConnection_.isSuperior()?c.highlightedConnection_:c.localConnection_).sourceBlock_.svg_.connectionUiEffect(),this.workspace.trashcan&&this.workspace.trashcan.isOpen&&c.Trashcan.close(this.workspace.trashcan);else if(this.workspace.trashcan&&this.workspace.trashcan.isOpen){var d=this.workspace.trashcan;window.setTimeout(function(){c.Trashcan.close(d)},100);c.selected.destroy(!1,!0);c.fireUiEvent(window,"resize")}c.highlightedConnection_&&(c.highlightedConnection_.unhighlight(),c.highlightedConnection_=
null)};c.Block.prototype.showHelp_=function(){var c="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;c&&window.open(c)};c.Block.prototype.duplicate_=function(){var d=c.Xml.blockToDom_(this);c.Xml.deleteNext(d);var d=c.Xml.domToBlock_(this.workspace,d),e=this.getRelativeToSurfaceXY();e.x=c.RTL?e.x-c.SNAP_RADIUS:e.x+c.SNAP_RADIUS;e.y+=2*c.SNAP_RADIUS;d.moveBy(e.x,e.y)};c.Block.prototype.showContextMenu_=function(d,e){if(this.contextMenu){var f=this,g=[];if(this.editable){g.push({text:c.MSG_DUPLICATE_BLOCK,
enabled:!0,callback:function(){f.duplicate_()}});if(c.Comment&&!this.collapsed){var h={enabled:!0};this.comment?(h.text=c.MSG_REMOVE_COMMENT,h.callback=function(){f.setCommentText(null)}):(h.text=c.MSG_ADD_COMMENT,h.callback=function(){f.setCommentText("")});g.push(h)}if(!this.collapsed)for(h=0;h<this.inputList.length;h++)if(this.inputList[h].type==c.INPUT_VALUE){h={enabled:!0};h.text=this.inputsInline?c.MSG_EXTERNAL_INPUTS:c.MSG_INLINE_INPUTS;h.callback=function(){f.setInputsInline(!f.inputsInline)};
g.push(h);break}this.collapsed?(h={enabled:!0},h.text=c.MSG_EXPAND_BLOCK,h.callback=function(){f.setCollapsed(!1)}):(h={enabled:!0},h.text=c.MSG_COLLAPSE_BLOCK,h.callback=function(){f.setCollapsed(!0)});g.push(h);h={text:this.disabled?c.MSG_ENABLE_BLOCK:c.MSG_DISABLE_BLOCK,enabled:!this.getInheritedDisabled(),callback:function(){f.setDisabled(!f.disabled)}};g.push(h);h=this.getDescendants().length;f.nextConnection&&f.nextConnection.targetConnection&&(h-=this.nextConnection.targetBlock().getDescendants().length);
h={text:1==h?c.MSG_DELETE_BLOCK:c.MSG_DELETE_X_BLOCKS.replace("%1",h),enabled:!0,callback:function(){f.destroy(!0,!0)}};g.push(h)}h={enabled:!!("function"==typeof this.helpUrl?this.helpUrl():this.helpUrl)};h.text=c.MSG_HELP;h.callback=function(){f.showHelp_()};g.push(h);this.customContextMenu&&this.customContextMenu(g);c.ContextMenu.show(d,e,g)}};c.Block.prototype.getConnections_=function(c){var e=[];if(c||this.rendered)if(this.outputConnection&&e.push(this.outputConnection),this.nextConnection&&
e.push(this.nextConnection),this.previousConnection&&e.push(this.previousConnection),c||!this.collapsed)for(var c=0,f;f=this.inputList[c];c++)f.connection&&e.push(f.connection);return e};c.Block.prototype.moveConnections_=function(c,e){if(this.rendered){for(var f=this.getConnections_(!1),g=0;g<f.length;g++)f[g].moveBy(c,e);this.mutator&&this.mutator.computeIconLocation();this.comment&&this.comment.computeIconLocation();this.warning&&this.warning.computeIconLocation();for(g=0;g<this.childBlocks_.length;g++)this.childBlocks_[g].moveConnections_(c,
e)}};c.Block.prototype.setDragging_=function(c){c?this.svg_.addDragging():this.svg_.removeDragging();for(var e=0;e<this.childBlocks_.length;e++)this.childBlocks_[e].setDragging_(c)};c.Block.prototype.onMouseMove_=function(d){if(!("mousemove"==d.type&&1==d.x&&0==d.y&&0==d.button)){c.removeAllRanges();var e=d.clientX-this.startDragMouseX,f=d.clientY-this.startDragMouseY;1==c.Block.dragMode_&&Math.sqrt(Math.pow(e,2)+Math.pow(f,2))>c.DRAG_RADIUS&&(c.Block.dragMode_=2,this.setParent(null),this.setDragging_(!0));
if(2==c.Block.dragMode_){var g=this.startDragX+e,h=this.startDragY+f;this.svg_.getRootNode().setAttribute("transform","translate("+g+", "+h+")");for(g=0;g<this.draggedBubbles_.length;g++)h=this.draggedBubbles_[g],h.bubble.setIconLocation(h.x+e,h.y+f);for(var g=this.getConnections_(!1),i=h=null,k=c.SNAP_RADIUS,j=0;j<g.length;j++){var l=g[j],m=l.closest(k,e,f);m.connection&&(h=m.connection,i=l,k=m.radius)}c.highlightedConnection_&&c.highlightedConnection_!=h&&(c.highlightedConnection_.unhighlight(),
c.highlightedConnection_=null,c.localConnection_=null);h&&h!=c.highlightedConnection_&&(h.highlight(),c.highlightedConnection_=h,c.localConnection_=i);this.workspace.trashcan&&this.workspace.trashcan.onMouseMove(d)}}d.stopPropagation()};c.Block.prototype.bumpNeighbours_=function(){for(var d=this.getRootBlock(),e=this.getConnections_(!1),f=0;f<e.length;f++){var g=e[f];g.targetConnection&&g.isSuperior()&&g.targetBlock().bumpNeighbours_();for(var h=g.neighbours_(c.SNAP_RADIUS),i=0;i<h.length;i++){var k=
h[i];if(!g.targetConnection||!k.targetConnection)k.sourceBlock_.getRootBlock()!=d&&(g.isSuperior()?k.bumpAwayFrom_(g):g.bumpAwayFrom_(k))}}};c.Block.prototype.getParent=function(){return this.parentBlock_};c.Block.prototype.getSurroundParent=function(){for(var c=this;;){do{var e=c,c=c.getParent();if(!c)return null}while(c.nextConnection&&c.nextConnection.targetBlock()==e);return c}};c.Block.prototype.getRootBlock=function(){var c,e=this;do c=e,e=c.parentBlock_;while(e);return c};c.Block.prototype.getChildren=
function(){return this.childBlocks_};c.Block.prototype.setParent=function(c){if(this.parentBlock_){for(var e=this.parentBlock_.childBlocks_,f,g=0;f=e[g];g++)if(f==this){e.splice(g,1);break}e=this.getRelativeToSurfaceXY();this.workspace.getCanvas().appendChild(this.svg_.getRootNode());this.svg_.getRootNode().setAttribute("transform","translate("+e.x+", "+e.y+")");this.parentBlock_=null;this.previousConnection&&this.previousConnection.targetConnection&&this.previousConnection.disconnect();this.outputConnection&&
this.outputConnection.targetConnection&&this.outputConnection.disconnect()}else this.workspace.removeTopBlock(this);(this.parentBlock_=c)?(c.childBlocks_.push(this),e=this.getRelativeToSurfaceXY(),c.svg_&&this.svg_&&c.svg_.getRootNode().appendChild(this.svg_.getRootNode()),c=this.getRelativeToSurfaceXY(),this.moveConnections_(c.x-e.x,c.y-e.y)):this.workspace.addTopBlock(this)};c.Block.prototype.getDescendants=function(){for(var c=[this],e,f=0;e=this.childBlocks_[f];f++)c=c.concat(e.getDescendants());
return c};c.Block.prototype.getColour=function(){return this.colourHue_};c.Block.prototype.setColour=function(c){this.colourHue_=c;this.svg_&&this.svg_.updateColour();this.mutator&&this.mutator.updateColour();this.comment&&this.comment.updateColour();this.warning&&this.warning.updateColour();this.rendered&&this.render()};c.Block.prototype.getTitle_=function(c){for(var e=0,f;f=this.inputList[e];e++)for(var g=0,h;h=f.titleRow[g];g++)if(h.name===c)return h;return null};c.Block.prototype.getTitleValue=
function(c){return(c=this.getTitle_(c))?c.getValue():null};c.Block.prototype.setTitleValue=function(c,e){var f=this.getTitle_(e);if(f)f.setValue(c);else throw'Title "'+e+'" not found.';};c.Block.prototype.getTitleText=function(c){console.log("Obsolete call to getTitleText.  Please use getTitleValue.");return(c=this.getTitle_(c))?c.getText():null};c.Block.prototype.setTitleText=function(c,e){console.log("Obsolete call to setTitleText.  Please use setTitleValue.");var f=this.getTitle_(e);if(f)f.setText(c);
else throw'Title "'+e+'" not found.';};c.Block.prototype.setTooltip=function(c){this.tooltip=c};c.Block.prototype.setPreviousStatement=function(d,e){if(this.previousConnection){if(this.previousConnection.targetConnection)throw"Must disconnect previous statement before removing connection.";this.previousConnection.destroy();this.previousConnection=null}if(d){if(this.outputConnection)throw"Remove output connection prior to adding previous connection.";void 0===e&&(e=null);this.previousConnection=new c.Connection(this,
c.PREVIOUS_STATEMENT);this.previousConnection.setCheck(e)}this.rendered&&(this.render(),this.bumpNeighbours_())};c.Block.prototype.setNextStatement=function(d,e){if(this.nextConnection){if(this.nextConnection.targetConnection)throw"Must disconnect next statement before removing connection.";this.nextConnection.destroy();this.nextConnection=null}d&&(void 0===e&&(e=null),this.nextConnection=new c.Connection(this,c.NEXT_STATEMENT),this.nextConnection.setCheck(e));this.rendered&&(this.render(),this.bumpNeighbours_())};
c.Block.prototype.setOutput=function(d,e){if(this.outputConnection){if(this.outputConnection.targetConnection)throw"Must disconnect output value before removing connection.";this.outputConnection.destroy();this.outputConnection=null}if(d){if(this.previousConnection)throw"Remove previous connection prior to adding output connection.";void 0===e&&(e=null);this.outputConnection=new c.Connection(this,c.OUTPUT_VALUE);this.outputConnection.setCheck(e)}this.rendered&&(this.render(),this.bumpNeighbours_())};
c.Block.prototype.setInputsInline=function(c){this.inputsInline=c;this.rendered&&(this.render(),this.bumpNeighbours_())};c.Block.prototype.setDisabled=function(c){this.disabled!=c&&(this.disabled=c,this.svg_.updateDisabled(),this.workspace.fireChangeEvent())};c.Block.prototype.getInheritedDisabled=function(){for(var c=this;;)if(c=c.getSurroundParent()){if(c.disabled)return!0}else return!1};c.Block.prototype.setCollapsed=function(c){if(this.collapsed!=c){for(var e=(this.collapsed=c)?"none":"block",
f=[],g=0,h;h=this.inputList[g];g++){for(var i=0,k;k=h.titleRow[i];i++)(k.getRootElement?k.getRootElement():k).style.display=e;if(h.connection&&(c?h.connection.hideAll():f=f.concat(h.connection.unhideAll()),h=h.connection.targetBlock()))h.svg_.getRootNode().style.display=e,c&&(h.rendered=!1)}c&&this.mutator&&this.mutator.setVisible(!1);c&&this.comment&&this.comment.setVisible(!1);c&&this.warning&&this.warning.setVisible(!1);0==f.length&&(f[0]=this);if(this.rendered){for(g=0;c=f[g];g++)c.render();this.bumpNeighbours_()}}};
c.Block.prototype.appendValueInput=function(d){return this.appendInput_(c.INPUT_VALUE,d)};c.Block.prototype.appendStatementInput=function(d){return this.appendInput_(c.NEXT_STATEMENT,d)};c.Block.prototype.appendDummyInput=function(d){return this.appendInput_(c.DUMMY_INPUT,d||"")};c.Block.prototype.appendInput_=function(d,e){var f=null;if(d==c.INPUT_VALUE||d==c.NEXT_STATEMENT)f=new c.Connection(this,d);f=new c.Input(d,e,this,f);this.inputList.push(f);this.rendered&&(this.render(),this.bumpNeighbours_());
return f};c.Block.prototype.moveInputBefore=function(c,e){if(c==e)throw"Can't move \""+c+'" to itself.';for(var f=-1,g=-1,h=0,i;i=this.inputList[h];h++)if(i.name==c){if(f=h,-1!=g)break}else if(i.name==e&&(g=h,-1!=f))break;if(-1==f)throw'Named input "'+c+'" not found.';if(-1==g)throw'Reference input "'+c+'" not found.';this.inputList.splice(f,1);f<g&&g--;this.inputList.splice(g,0,i);this.rendered&&(this.render(),this.bumpNeighbours_())};c.Block.prototype.removeInput=function(c){for(var e=0,f;f=this.inputList[e];e++)if(f.name==
c){f.connection&&f.connection.targetConnection&&f.connection.targetBlock().setParent(null);f.destroy();this.inputList.splice(e,1);this.rendered&&(this.render(),this.bumpNeighbours_());return}throw'Input "'+c+'" not found.';};c.Block.prototype.getInput=function(c){for(var e=0,f;f=this.inputList[e];e++)if(f.name==c)return f;return null};c.Block.prototype.getInputTargetBlock=function(c){return(c=this.getInput(c))&&c.connection&&c.connection.targetBlock()};c.Block.prototype.setMutator=function(c){this.mutator&&
this.mutator!==c&&this.mutator.destroy();c&&(c.block_=this,this.mutator=c,this.svg_&&c.createIcon())};c.Block.prototype.getCommentText=function(){return this.comment?this.comment.getText().replace(/\s+$/,"").replace(/ +\n/g,"\n"):""};c.Block.prototype.setCommentText=function(d){if(!c.Comment)throw"Comments not supported.";var e=!1;"string"==typeof d?(this.comment||(this.comment=new c.Comment(this),e=!0),this.comment.setText(d)):this.comment&&(this.comment.destroy(),e=!0);this.rendered&&(this.render(),
e&&this.bumpNeighbours_())};c.Block.prototype.setWarningText=function(d){if(!c.Warning)throw"Warnings not supported.";var e=!1;"string"==typeof d?(this.warning||(this.warning=new c.Warning(this),e=!0),this.warning.setText(d)):this.warning&&(this.warning.destroy(),e=!0);this.rendered&&(this.render(),e&&this.bumpNeighbours_())};c.Block.prototype.render=function(){this.svg_.render()}}).call(this,Blockly);(function(c){c.BlockSvg=function(d){this.block_=d;this.svgGroup_=c.createSvgElement("g",{},null);this.svgPathDark_=c.createSvgElement("path",{"class":"blocklyPathDark",transform:"translate(1, 1)"},this.svgGroup_);this.svgPath_=c.createSvgElement("path",{"class":"blocklyPath"},this.svgGroup_);this.svgPathLight_=c.createSvgElement("path",{"class":"blocklyPathLight"},this.svgGroup_);this.svgPath_.tooltip=this.block_;c.Tooltip&&c.Tooltip.bindMouseEvents(this.svgPath_);d.editable&&c.addClass_(this.svgGroup_,
"blocklyDraggable")};c.BlockSvg.INLINE=-1;c.BlockSvg.prototype.init=function(){var c=this.block_;this.updateColour();for(var e=0,f;f=c.inputList[e];e++)f.init();c.mutator&&c.mutator.createIcon()};c.BlockSvg.prototype.getRootNode=function(){return this.svgGroup_};c.BlockSvg.SEP_SPACE_X=10;c.BlockSvg.SEP_SPACE_Y=5;c.BlockSvg.MIN_BLOCK_Y=25;c.BlockSvg.TAB_HEIGHT=20;c.BlockSvg.TAB_WIDTH=8;c.BlockSvg.NOTCH_WIDTH=30;c.BlockSvg.CORNER_RADIUS=8;c.BlockSvg.TITLE_HEIGHT=18;c.BlockSvg.DISTANCE_45_INSIDE=(1-
Math.SQRT1_2)*(c.BlockSvg.CORNER_RADIUS-1)+1;c.BlockSvg.DISTANCE_45_OUTSIDE=(1-Math.SQRT1_2)*(c.BlockSvg.CORNER_RADIUS+1)-1;c.BlockSvg.NOTCH_PATH_LEFT="l 6,4 3,0 6,-4";c.BlockSvg.NOTCH_PATH_LEFT_HIGHLIGHT="l 6.5,4 2,0 6.5,-4";c.BlockSvg.NOTCH_PATH_RIGHT="l -6,4 -3,0 -6,-4";c.BlockSvg.JAGGED_TEETH="l 8,0 0,4 8,4 -16,8 8,4";c.BlockSvg.TAB_PATH_DOWN="v 5 c 0,10 -"+c.BlockSvg.TAB_WIDTH+",-8 -"+c.BlockSvg.TAB_WIDTH+",7.5 s "+c.BlockSvg.TAB_WIDTH+",-2.5 "+c.BlockSvg.TAB_WIDTH+",7.5";c.BlockSvg.TAB_PATH_DOWN_HIGHLIGHT_RTL=
"v 6.5 m -"+0.98*c.BlockSvg.TAB_WIDTH+",2.5 q -"+0.05*c.BlockSvg.TAB_WIDTH+",10 "+0.27*c.BlockSvg.TAB_WIDTH+",10 m "+0.71*c.BlockSvg.TAB_WIDTH+",-2.5 v 1.5";c.BlockSvg.TOP_LEFT_CORNER_START="m 0,"+c.BlockSvg.CORNER_RADIUS;c.BlockSvg.TOP_LEFT_CORNER_START_HIGHLIGHT_RTL="m "+c.BlockSvg.DISTANCE_45_INSIDE+","+c.BlockSvg.DISTANCE_45_INSIDE;c.BlockSvg.TOP_LEFT_CORNER_START_HIGHLIGHT_LTR="m 1,"+(c.BlockSvg.CORNER_RADIUS-1);c.BlockSvg.TOP_LEFT_CORNER="A "+c.BlockSvg.CORNER_RADIUS+","+c.BlockSvg.CORNER_RADIUS+
" 0 0,1 "+c.BlockSvg.CORNER_RADIUS+",0";c.BlockSvg.TOP_LEFT_CORNER_HIGHLIGHT="A "+(c.BlockSvg.CORNER_RADIUS-1)+","+(c.BlockSvg.CORNER_RADIUS-1)+" 0 0,1 "+c.BlockSvg.CORNER_RADIUS+",1";c.BlockSvg.INNER_TOP_LEFT_CORNER=c.BlockSvg.NOTCH_PATH_RIGHT+" h -"+(c.BlockSvg.NOTCH_WIDTH-15-c.BlockSvg.CORNER_RADIUS)+" a "+c.BlockSvg.CORNER_RADIUS+","+c.BlockSvg.CORNER_RADIUS+" 0 0,0 -"+c.BlockSvg.CORNER_RADIUS+","+c.BlockSvg.CORNER_RADIUS;c.BlockSvg.INNER_BOTTOM_LEFT_CORNER="a "+c.BlockSvg.CORNER_RADIUS+","+c.BlockSvg.CORNER_RADIUS+
" 0 0,0 "+c.BlockSvg.CORNER_RADIUS+","+c.BlockSvg.CORNER_RADIUS;c.BlockSvg.INNER_TOP_LEFT_CORNER_HIGHLIGHT_RTL="a "+(c.BlockSvg.CORNER_RADIUS+1)+","+(c.BlockSvg.CORNER_RADIUS+1)+" 0 0,0 "+(-c.BlockSvg.DISTANCE_45_OUTSIDE-1)+","+(c.BlockSvg.CORNER_RADIUS-c.BlockSvg.DISTANCE_45_OUTSIDE);c.BlockSvg.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_RTL="a "+(c.BlockSvg.CORNER_RADIUS+1)+","+(c.BlockSvg.CORNER_RADIUS+1)+" 0 0,0 "+(c.BlockSvg.CORNER_RADIUS+1)+","+(c.BlockSvg.CORNER_RADIUS+1);c.BlockSvg.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_LTR=
"a "+(c.BlockSvg.CORNER_RADIUS+1)+","+(c.BlockSvg.CORNER_RADIUS+1)+" 0 0,0 "+(c.BlockSvg.CORNER_RADIUS-c.BlockSvg.DISTANCE_45_OUTSIDE)+","+(c.BlockSvg.DISTANCE_45_OUTSIDE+1);c.BlockSvg.prototype.destroy=function(){this.svgGroup_.parentNode.removeChild(this.svgGroup_);this.block_=this.svgPathDark_=this.svgPathLight_=this.svgPath_=this.svgGroup_=null};c.BlockSvg.prototype.destroyUiEffect=function(){c.playAudio("delete");var d=c.getAbsoluteXY_(this.svgGroup_),e=this.svgGroup_.cloneNode(!0);e.translateX_=
d.x;e.translateY_=d.y;e.setAttribute("transform","translate("+e.translateX_+","+e.translateY_+")");c.svg.appendChild(e);e.bBox_=e.getBBox();e.startDate_=new Date;c.BlockSvg.destroyUiStep_(e)};c.BlockSvg.destroyUiStep_=function(d){var e=(new Date-d.startDate_)/150;1<e?d.parentNode.removeChild(d):(d.setAttribute("transform","translate("+(d.translateX_+(c.RTL?-1:1)*d.bBox_.width/2*e+", "+(d.translateY_+d.bBox_.height*e))+") scale("+(1-e)+")"),window.setTimeout(function(){c.BlockSvg.destroyUiStep_(d)},
10))};c.BlockSvg.prototype.connectionUiEffect=function(){c.playAudio("click");var d=c.getAbsoluteXY_(this.svgGroup_);this.block_.outputConnection?(d.x+=c.RTL?3:-3,d.y+=13):this.block_.previousConnection&&(d.x+=c.RTL?-23:23,d.y+=3);d=c.createSvgElement("circle",{cx:d.x,cy:d.y,r:0,fill:"none",stroke:"#888","stroke-width":10},c.svg);d.startDate_=new Date;c.BlockSvg.connectionUiStep_(d)};c.BlockSvg.connectionUiStep_=function(d){var e=(new Date-d.startDate_)/150;1<e?d.parentNode.removeChild(d):(d.setAttribute("r",
25*e),d.style.opacity=1-e,window.setTimeout(function(){c.BlockSvg.connectionUiStep_(d)},10))};c.BlockSvg.prototype.updateColour=function(){var d=c.makeColour(this.block_.getColour()),e=window.parseInt(d.charAt(1),16),f=window.parseInt(d.charAt(2),16),g=window.parseInt(d.charAt(3),16),h="0123456789abcdef".charAt(Math.min(e+3,15)),i="0123456789abcdef".charAt(Math.min(f+2,15)),k="0123456789abcdef".charAt(Math.min(g+2,15)),e="0123456789abcdef".charAt(Math.max(e-4,0)),f="0123456789abcdef".charAt(Math.max(f-
4,0)),g="0123456789abcdef".charAt(Math.max(g-4,0));this.svgPathLight_.setAttribute("stroke","#"+h+i+k);this.svgPathDark_.setAttribute("fill","#"+e+f+g);this.svgPath_.setAttribute("fill",d)};c.BlockSvg.prototype.updateDisabled=function(){this.block_.disabled||this.block_.getInheritedDisabled()?(c.addClass_(this.svgGroup_,"blocklyDisabled"),this.svgPath_.setAttribute("fill","url(#blocklyDisabledPattern)")):(c.removeClass_(this.svgGroup_,"blocklyDisabled"),this.updateColour());for(var d=this.block_.getChildren(),
e=0,f;f=d[e];e++)f.svg_.updateDisabled()};c.BlockSvg.prototype.addSelect=function(){c.addClass_(this.svgGroup_,"blocklySelected");this.svgGroup_.parentNode.appendChild(this.svgGroup_)};c.BlockSvg.prototype.removeSelect=function(){c.removeClass_(this.svgGroup_,"blocklySelected")};c.BlockSvg.prototype.addDragging=function(){c.addClass_(this.svgGroup_,"blocklyDragging")};c.BlockSvg.prototype.removeDragging=function(){c.removeClass_(this.svgGroup_,"blocklyDragging")};c.BlockSvg.prototype.render=function(){this.block_.rendered=
!0;var d=c.BlockSvg.SEP_SPACE_X;c.RTL&&(d=-d);this.block_.mutator&&(d=this.block_.mutator.renderIcon(d));this.block_.comment&&(d=this.block_.comment.renderIcon(d));this.block_.warning&&(d=this.block_.warning.renderIcon(d));var d=d+(c.RTL?c.BlockSvg.SEP_SPACE_X:-c.BlockSvg.SEP_SPACE_X),e=this.renderCompute_(d);this.renderDraw_(d,e);(d=this.block_.getParent())?d.render():c.fireUiEvent(window,"resize")};c.BlockSvg.prototype.renderTitles_=function(d,e,f){c.RTL&&(e=-e);for(var g=0,h;h=d[g];g++){var i=
h.getSize().width;c.RTL?(e-=i,h.getRootElement().setAttribute("transform","translate("+e+", "+f+")"),i&&(e-=c.BlockSvg.SEP_SPACE_X)):(h.getRootElement().setAttribute("transform","translate("+e+", "+f+")"),i&&(e+=i+c.BlockSvg.SEP_SPACE_X))}return c.RTL?-e:e};c.BlockSvg.prototype.renderCompute_=function(d){var e=this.block_.inputList,f=[];f.rightEdge=d+2*c.BlockSvg.SEP_SPACE_X;if(this.block_.previousConnection||this.block_.nextConnection)f.rightEdge=Math.max(f.rightEdge,c.BlockSvg.NOTCH_WIDTH+c.BlockSvg.SEP_SPACE_X);
if(this.block_.collapsed)return f;for(var g=0,h=0,i=!1,k=!1,j=!1,l=void 0,m=0,n;n=e[m];m++){var p;!this.block_.inputsInline||!l||l==c.NEXT_STATEMENT||n.type==c.NEXT_STATEMENT?(l=n.type,p=[],p.type=this.block_.inputsInline&&n.type!=c.NEXT_STATEMENT?c.BlockSvg.INLINE:n.type,p.height=0,f.push(p)):p=f[f.length-1];p.push(n);n.renderHeight=c.BlockSvg.MIN_BLOCK_Y;n.renderWidth=this.block_.inputsInline&&n.type==c.INPUT_VALUE?c.BlockSvg.TAB_WIDTH+c.BlockSvg.SEP_SPACE_X:0;if(n.connection&&n.connection.targetConnection){var r=
n.connection.targetBlock().getSvgRoot();try{var s=r.getBBox()}catch(q){s={height:0,width:0}}-1!=window.navigator.userAgent.indexOf("AppleWebKit/")&&(s.height-=3);n.renderHeight=Math.max(n.renderHeight,s.height-1);n.renderWidth=Math.max(n.renderWidth,s.width)}p.height=Math.max(p.height,n.renderHeight);n.titleWidth=0;1==f.length&&(n.titleWidth+=c.RTL?-d:d);for(var r=0,t;t=n.titleRow[r];r++)0!=r&&(n.titleWidth+=c.BlockSvg.SEP_SPACE_X),t=t.getSize(),n.titleWidth+=t.width,p.height=Math.max(p.height,t.height);
p.type!=c.BlockSvg.INLINE&&(p.type==c.NEXT_STATEMENT?(k=!0,h=Math.max(h,n.titleWidth)):(p.type==c.INPUT_VALUE?i=!0:p.type==c.DUMMY_INPUT&&(j=!0),g=Math.max(g,n.titleWidth)))}for(d=0;p=f[d];d++)if(p.thicker=!1,this.block_.inputsInline&&p.type==c.BlockSvg.INLINE)for(e=0;n=p[e];e++)if(n.type==c.INPUT_VALUE){p.height+=2*c.BlockSvg.SEP_SPACE_Y;p.thicker=!0;break}f.statementEdge=2*c.BlockSvg.SEP_SPACE_X+h;k&&(f.rightEdge=Math.max(f.rightEdge,f.statementEdge+c.BlockSvg.NOTCH_WIDTH));i?f.rightEdge=Math.max(f.rightEdge,
g+2*c.BlockSvg.SEP_SPACE_X+c.BlockSvg.TAB_WIDTH):j&&(f.rightEdge=Math.max(f.rightEdge,g+2*c.BlockSvg.SEP_SPACE_X));f.hasValue=i;f.hasStatement=k;f.hasDummy=j;return f};c.BlockSvg.prototype.renderDraw_=function(d,e){if(this.block_.outputConnection)this.squareBottomLeftCorner_=this.squareTopLeftCorner_=!0;else{this.squareBottomLeftCorner_=this.squareTopLeftCorner_=!1;if(this.block_.previousConnection){var f=this.block_.previousConnection.targetBlock();f&&(f.nextConnection&&f.nextConnection.targetConnection==
this.block_.previousConnection)&&(this.squareTopLeftCorner_=!0)}if(this.block_.nextConnection&&(f=this.block_.nextConnection.targetBlock())&&f.previousConnection&&f.previousConnection.targetConnection==this.block_.nextConnection)this.squareBottomLeftCorner_=!0}var g=this.block_.getRelativeToSurfaceXY(),h=[],i=[],f=[],k=[];this.renderDrawTop_(h,f,g,e.rightEdge);var j=this.renderDrawRight_(h,f,i,k,g,e,d);this.renderDrawBottom_(h,f,g,j);this.renderDrawLeft_(h,f,g,j);g=h.join(" ")+"\n"+i.join(" ");this.svgPath_.setAttribute("d",
g);this.svgPathDark_.setAttribute("d",g);g=f.join(" ")+"\n"+k.join(" ");this.svgPathLight_.setAttribute("d",g);c.RTL&&(this.svgPath_.setAttribute("transform","scale(-1 1)"),this.svgPathLight_.setAttribute("transform","scale(-1 1)"),this.svgPathDark_.setAttribute("transform","translate(1,1) scale(-1 1)"))};c.BlockSvg.prototype.renderDrawTop_=function(d,e,f,g){this.squareTopLeftCorner_?(d.push("m 0,0"),e.push("m 1,1")):(d.push(c.BlockSvg.TOP_LEFT_CORNER_START),e.push(c.RTL?c.BlockSvg.TOP_LEFT_CORNER_START_HIGHLIGHT_RTL:
c.BlockSvg.TOP_LEFT_CORNER_START_HIGHLIGHT_LTR),d.push(c.BlockSvg.TOP_LEFT_CORNER),e.push(c.BlockSvg.TOP_LEFT_CORNER_HIGHLIGHT));this.block_.previousConnection&&(d.push("H",c.BlockSvg.NOTCH_WIDTH-15),e.push("H",c.BlockSvg.NOTCH_WIDTH-15),d.push(c.BlockSvg.NOTCH_PATH_LEFT),e.push(c.BlockSvg.NOTCH_PATH_LEFT_HIGHLIGHT),this.block_.previousConnection.moveTo(f.x+(c.RTL?-c.BlockSvg.NOTCH_WIDTH:c.BlockSvg.NOTCH_WIDTH),f.y));d.push("H",g);e.push("H",g+(c.RTL?-1:0))};c.BlockSvg.prototype.renderDrawRight_=
function(d,e,f,g,h,i,k){for(var j,l=0,m,n,p=0,r;r=i[p];p++){j=c.BlockSvg.SEP_SPACE_X;0==p&&(j+=c.RTL?-k:k);e.push("M",i.rightEdge-1+","+(l+1));if(r.type==c.BlockSvg.INLINE){for(var s=0,q;q=r[s];s++)m=l+c.BlockSvg.TITLE_HEIGHT,r.thicker&&(m+=c.BlockSvg.SEP_SPACE_Y),j=this.renderTitles_(q.titleRow,j,m),q.type!=c.DUMMY_INPUT&&(j+=q.renderWidth+c.BlockSvg.SEP_SPACE_X),q.type==c.INPUT_VALUE&&(f.push("M",j-c.BlockSvg.SEP_SPACE_X+","+(l+c.BlockSvg.SEP_SPACE_Y)),f.push("h",c.BlockSvg.TAB_WIDTH-q.renderWidth),
f.push(c.BlockSvg.TAB_PATH_DOWN),f.push("v",q.renderHeight-c.BlockSvg.TAB_HEIGHT),f.push("h",q.renderWidth-c.BlockSvg.TAB_WIDTH),f.push("z"),c.RTL?(g.push("M",j-c.BlockSvg.SEP_SPACE_X+c.BlockSvg.TAB_WIDTH-q.renderWidth-1+","+(l+c.BlockSvg.SEP_SPACE_Y+1)),g.push(c.BlockSvg.TAB_PATH_DOWN_HIGHLIGHT_RTL),g.push("v",q.renderHeight-c.BlockSvg.TAB_HEIGHT+2),g.push("h",q.renderWidth-c.BlockSvg.TAB_WIDTH)):(g.push("M",j-c.BlockSvg.SEP_SPACE_X+1+","+(l+c.BlockSvg.SEP_SPACE_Y+1)),g.push("v",q.renderHeight),
g.push("h",c.BlockSvg.TAB_WIDTH-q.renderWidth),g.push("M",j-q.renderWidth-c.BlockSvg.SEP_SPACE_X+3.8+","+(l+c.BlockSvg.SEP_SPACE_Y+c.BlockSvg.TAB_HEIGHT-0.4)),g.push("l",0.42*c.BlockSvg.TAB_WIDTH+",-1.8")),m=c.RTL?h.x-j-c.BlockSvg.TAB_WIDTH+c.BlockSvg.SEP_SPACE_X+q.renderWidth-1:h.x+j+c.BlockSvg.TAB_WIDTH-c.BlockSvg.SEP_SPACE_X-q.renderWidth+1,n=h.y+l+c.BlockSvg.SEP_SPACE_Y,q.connection.moveTo(m,n),q.connection.targetConnection&&q.connection.tighten_());j=Math.max(j,i.rightEdge);d.push("H",j);e.push("H",
j+(c.RTL?-1:0));d.push("v",r.height);c.RTL&&e.push("v",r.height-2)}else if(r.type==c.INPUT_VALUE)q=r[0],m=l+c.BlockSvg.TITLE_HEIGHT,q.align!=c.ALIGN_LEFT&&(s=i.rightEdge-q.titleWidth-c.BlockSvg.TAB_WIDTH-c.BlockSvg.SEP_SPACE_X,q.align==c.ALIGN_RIGHT?j=s:q.align==c.ALIGN_CENTRE&&(j=(s+j)/2)),this.renderTitles_(q.titleRow,j,m),d.push(c.BlockSvg.TAB_PATH_DOWN),d.push("v",r.height-c.BlockSvg.TAB_HEIGHT),c.RTL?(e.push(c.BlockSvg.TAB_PATH_DOWN_HIGHLIGHT_RTL),e.push("v",r.height-c.BlockSvg.TAB_HEIGHT)):
(e.push("M",i.rightEdge-4.2+","+(l+c.BlockSvg.TAB_HEIGHT-0.4)),e.push("l",0.42*c.BlockSvg.TAB_WIDTH+",-1.8")),m=h.x+(c.RTL?-i.rightEdge-1:i.rightEdge+1),n=h.y+l,q.connection.moveTo(m,n),q.connection.targetConnection&&q.connection.tighten_();else if(r.type==c.DUMMY_INPUT)q=r[0],m=l+c.BlockSvg.TITLE_HEIGHT,q.align!=c.ALIGN_LEFT&&(s=i.rightEdge-q.titleWidth-c.BlockSvg.SEP_SPACE_X,i.hasValue&&(s-=c.BlockSvg.TAB_WIDTH),q.align==c.ALIGN_RIGHT?j=s:q.align==c.ALIGN_CENTRE&&(j=(s+j)/2)),this.renderTitles_(q.titleRow,
j,m),d.push("v",r.height),c.RTL&&e.push("v",r.height-2);else if(r.type==c.NEXT_STATEMENT&&(q=r[0],0==p&&(d.push("v",c.BlockSvg.SEP_SPACE_Y),c.RTL&&e.push("v",c.BlockSvg.SEP_SPACE_Y-1),l+=c.BlockSvg.SEP_SPACE_Y),m=l+c.BlockSvg.TITLE_HEIGHT,q.align!=c.ALIGN_LEFT&&(s=i.statementEdge-q.titleWidth-c.BlockSvg.SEP_SPACE_X,q.align==c.ALIGN_RIGHT?j=s:q.align==c.ALIGN_CENTRE&&(j=(s+j)/2)),this.renderTitles_(q.titleRow,j,m),j=i.statementEdge+c.BlockSvg.NOTCH_WIDTH,d.push("H",j),d.push(c.BlockSvg.INNER_TOP_LEFT_CORNER),
d.push("v",r.height-2*c.BlockSvg.CORNER_RADIUS),d.push(c.BlockSvg.INNER_BOTTOM_LEFT_CORNER),d.push("H",i.rightEdge),c.RTL?(e.push("M",j-c.BlockSvg.NOTCH_WIDTH+c.BlockSvg.DISTANCE_45_OUTSIDE+","+(l+c.BlockSvg.DISTANCE_45_OUTSIDE)),e.push(c.BlockSvg.INNER_TOP_LEFT_CORNER_HIGHLIGHT_RTL),e.push("v",r.height-2*c.BlockSvg.CORNER_RADIUS),e.push(c.BlockSvg.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_RTL),e.push("H",i.rightEdge-1)):(e.push("M",j-c.BlockSvg.NOTCH_WIDTH+c.BlockSvg.DISTANCE_45_OUTSIDE+","+(l+r.height-
c.BlockSvg.DISTANCE_45_OUTSIDE)),e.push(c.BlockSvg.INNER_BOTTOM_LEFT_CORNER_HIGHLIGHT_LTR),e.push("H",i.rightEdge)),m=h.x+(c.RTL?-j:j),n=h.y+l+1,q.connection.moveTo(m,n),q.connection.targetConnection&&q.connection.tighten_(),p==i.length-1||i[p+1].type==c.NEXT_STATEMENT))d.push("v",c.BlockSvg.SEP_SPACE_Y),c.RTL&&e.push("v",c.BlockSvg.SEP_SPACE_Y-1),l+=c.BlockSvg.SEP_SPACE_Y;l+=r.height}i.length||(this.block_.collapsed&&(d.push(c.BlockSvg.JAGGED_TEETH),c.RTL?e.push("l 8,0 0,3.8 7,3.2 m -14.5,9 l 8,4"):
e.push("h 8")),l=c.BlockSvg.MIN_BLOCK_Y,d.push("V",l),c.RTL&&e.push("V",l-1));return l};c.BlockSvg.prototype.renderDrawBottom_=function(d,e,f,g){this.block_.nextConnection&&(d.push("H",c.BlockSvg.NOTCH_WIDTH+" "+c.BlockSvg.NOTCH_PATH_RIGHT),this.block_.nextConnection.moveTo(c.RTL?f.x-c.BlockSvg.NOTCH_WIDTH:f.x+c.BlockSvg.NOTCH_WIDTH,f.y+g+1),this.block_.nextConnection.targetConnection&&this.block_.nextConnection.tighten_());this.squareBottomLeftCorner_?(d.push("H 0"),c.RTL||e.push("M","1,"+g)):(d.push("H",
c.BlockSvg.CORNER_RADIUS),d.push("a",c.BlockSvg.CORNER_RADIUS+","+c.BlockSvg.CORNER_RADIUS+" 0 0,1 -"+c.BlockSvg.CORNER_RADIUS+",-"+c.BlockSvg.CORNER_RADIUS),c.RTL||(e.push("M",c.BlockSvg.DISTANCE_45_INSIDE+","+(g-c.BlockSvg.DISTANCE_45_INSIDE)),e.push("A",c.BlockSvg.CORNER_RADIUS-1+","+(c.BlockSvg.CORNER_RADIUS-1)+" 0 0,1 1,"+(g-c.BlockSvg.CORNER_RADIUS))))};c.BlockSvg.prototype.renderDrawLeft_=function(d,e,f){this.block_.outputConnection?(this.block_.outputConnection.moveTo(f.x,f.y),d.push("V",
c.BlockSvg.TAB_HEIGHT),d.push("c 0,-10 -"+c.BlockSvg.TAB_WIDTH+",8 -"+c.BlockSvg.TAB_WIDTH+",-7.5 s "+c.BlockSvg.TAB_WIDTH+",2.5 "+c.BlockSvg.TAB_WIDTH+",-7.5"),c.RTL?(e.push("M",-0.3*c.BlockSvg.TAB_WIDTH+",8.9"),e.push("l",-0.45*c.BlockSvg.TAB_WIDTH+",-2.1")):(e.push("V",c.BlockSvg.TAB_HEIGHT-1),e.push("m",-0.92*c.BlockSvg.TAB_WIDTH+",-1 q "+-0.19*c.BlockSvg.TAB_WIDTH+",-5.5 0,-11"),e.push("m",0.92*c.BlockSvg.TAB_WIDTH+",1 V 1 H 2"))):c.RTL||(this.squareTopLeftCorner_?e.push("V",1):e.push("V",c.BlockSvg.CORNER_RADIUS));
d.push("z")}}).call(this,Blockly);(function(c){c.Bubble=function(d,e,f,g,h,i,k,j){var l=c.Bubble.ARROW_ANGLE;c.RTL&&(l=-l);this.arrow_radians_=2*l/360*Math.PI;this.content_=e;d.appendChild(this.createDom_(e,k&&j));this.rendered_=!1;this.setAnchorLocation(f,g);this.setBubbleLocation(h,i);if(!k||!j)d=this.content_.getBBox(),k=d.width+2*c.Bubble.BORDER_WIDTH,j=d.height+2*c.Bubble.BORDER_WIDTH;this.setBubbleSize(k,j);this.positionBubble_();this.renderArrow_();this.rendered_=!0;c.bindEvent_(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_);
this.resizeGroup_&&c.bindEvent_(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_)};c.Bubble.BORDER_WIDTH=6;c.Bubble.ARROW_THICKNESS=10;c.Bubble.ARROW_ANGLE=20;c.Bubble.ARROW_BEND=4;c.Bubble.ANCHOR_RADIUS=8;c.Bubble.onMouseUpWrapper_=null;c.Bubble.onMouseMoveWrapper_=null;c.Bubble.rendered_=!1;c.Bubble.unbindDragEvents_=function(){c.Bubble.onMouseUpWrapper_&&(c.unbindEvent_(c.Bubble.onMouseUpWrapper_),c.Bubble.onMouseUpWrapper_=null);c.Bubble.onMouseMoveWrapper_&&(c.unbindEvent_(c.Bubble.onMouseMoveWrapper_),
c.Bubble.onMouseMoveWrapper_=null)};c.Bubble.prototype.anchorX_=0;c.Bubble.prototype.anchorY_=0;c.Bubble.prototype.relativeLeft_=0;c.Bubble.prototype.relativeTop_=0;c.Bubble.prototype.width_=0;c.Bubble.prototype.height_=0;c.Bubble.prototype.createDom_=function(d,e){this.bubbleGroup_=c.createSvgElement("g",{},null);var f=c.createSvgElement("g",{filter:"url(#blocklyEmboss)"},this.bubbleGroup_);this.bubbleArrow_=c.createSvgElement("path",{},f);this.bubbleBack_=c.createSvgElement("rect",{"class":"blocklyDraggable",
x:0,y:0,rx:c.Bubble.BORDER_WIDTH,ry:c.Bubble.BORDER_WIDTH},f);e?(this.resizeGroup_=c.createSvgElement("g",{"class":c.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_),f=2*c.Bubble.BORDER_WIDTH,c.createSvgElement("polygon",{points:"0,x x,x x,0".replace(/x/g,f)},this.resizeGroup_),c.createSvgElement("line",{"class":"blocklyResizeLine",x1:f/3,y1:f-1,x2:f-1,y2:f/3},this.resizeGroup_),c.createSvgElement("line",{"class":"blocklyResizeLine",x1:2*f/3,y1:f-1,x2:f-1,y2:2*f/3},this.resizeGroup_)):
this.resizeGroup_=null;this.bubbleGroup_.appendChild(d);return this.bubbleGroup_};c.Bubble.prototype.bubbleMouseDown_=function(d){this.promote_();c.Bubble.unbindDragEvents_();!c.isRightButton(d)&&!c.isTargetInput_(d)&&(c.setCursorHand_(!0),this.dragDeltaX=c.RTL?this.relativeLeft_+d.clientX:this.relativeLeft_-d.clientX,this.dragDeltaY=this.relativeTop_-d.clientY,c.Bubble.onMouseUpWrapper_=c.bindEvent_(c.svgDoc,"mouseup",this,c.Bubble.unbindDragEvents_),c.Bubble.onMouseMoveWrapper_=c.bindEvent_(c.svgDoc,
"mousemove",this,this.bubbleMouseMove_),c.hideChaff(),d.stopPropagation())};c.Bubble.prototype.bubbleMouseMove_=function(d){this.relativeLeft_=c.RTL?this.dragDeltaX-d.clientX:this.dragDeltaX+d.clientX;this.relativeTop_=this.dragDeltaY+d.clientY;this.positionBubble_();this.renderArrow_()};c.Bubble.prototype.resizeMouseDown_=function(d){this.promote_();c.Bubble.unbindDragEvents_();c.isRightButton(d)||(c.setCursorHand_(!0),this.resizeDeltaWidth=c.RTL?this.width_+d.clientX:this.width_-d.clientX,this.resizeDeltaHeight=
this.height_-d.clientY,c.Bubble.onMouseUpWrapper_=c.bindEvent_(c.svgDoc,"mouseup",this,c.Bubble.unbindDragEvents_),c.Bubble.onMouseMoveWrapper_=c.bindEvent_(c.svgDoc,"mousemove",this,this.resizeMouseMove_),c.hideChaff(),d.stopPropagation())};c.Bubble.prototype.resizeMouseMove_=function(d){var e=this.resizeDeltaWidth,f=this.resizeDeltaHeight+d.clientY,e=c.RTL?e-d.clientX:e+d.clientX;this.setBubbleSize(e,f);c.RTL&&this.positionBubble_()};c.Bubble.prototype.registerResizeEvent=function(d,e){c.bindEvent_(this.bubbleGroup_,
"resize",d,e)};c.Bubble.prototype.promote_=function(){this.bubbleGroup_.parentNode.appendChild(this.bubbleGroup_)};c.Bubble.prototype.setAnchorLocation=function(c,e){this.anchorX_=c;this.anchorY_=e;this.rendered_&&this.positionBubble_()};c.Bubble.prototype.getBubbleLocation=function(){return{x:this.relativeLeft_,y:this.relativeTop_}};c.Bubble.prototype.setBubbleLocation=function(c,e){this.relativeLeft_=c;this.relativeTop_=e;this.rendered_&&this.positionBubble_()};c.Bubble.prototype.positionBubble_=
function(){this.bubbleGroup_.setAttribute("transform","translate("+(c.RTL?this.anchorX_-this.relativeLeft_-this.width_:this.anchorX_+this.relativeLeft_)+", "+(this.relativeTop_+this.anchorY_)+")")};c.Bubble.prototype.getBubbleSize=function(){return{width:this.width_,height:this.height_}};c.Bubble.prototype.setBubbleSize=function(d,e){var f=2*c.Bubble.BORDER_WIDTH,d=Math.max(d,f+45),e=Math.max(e,f+c.BlockSvg.TITLE_HEIGHT);this.width_=d;this.height_=e;this.bubbleBack_.setAttribute("width",d);this.bubbleBack_.setAttribute("height",
e);this.resizeGroup_&&(c.RTL?this.resizeGroup_.setAttribute("transform","translate("+2*c.Bubble.BORDER_WIDTH+", "+(e-f)+") scale(-1 1)"):this.resizeGroup_.setAttribute("transform","translate("+(d-f)+", "+(e-f)+")"));this.rendered_&&(c.RTL&&this.positionBubble_(),this.renderArrow_());c.fireUiEvent(this.bubbleGroup_,"resize")};c.Bubble.prototype.renderArrow_=function(){var d=[],e=this.width_/2,f=this.height_/2,g=-this.relativeLeft_,h=-this.relativeTop_;if(e==g&&f==h)d.push("M "+e+","+f);else{h-=f;g-=
e;c.RTL&&(g*=-1);var i=Math.sqrt(h*h+g*g),k=Math.acos(g/i);0>h&&(k=2*Math.PI-k);var j=k+Math.PI/2;j>2*Math.PI&&(j-=2*Math.PI);var l=Math.sin(j),m=Math.cos(j),n=this.getBubbleSize(),j=(n.width+n.height)/c.Bubble.ARROW_THICKNESS,j=Math.min(j,n.width,n.height)/2,n=1-c.Bubble.ANCHOR_RADIUS/i,g=e+n*g,h=f+n*h,n=e+j*m,p=f+j*l,e=e-j*m,f=f-j*l,l=k+this.arrow_radians_;l>2*Math.PI&&(l-=2*Math.PI);k=Math.sin(l)*i/c.Bubble.ARROW_BEND;i=Math.cos(l)*i/c.Bubble.ARROW_BEND;d.push("M"+n+","+p);d.push("C"+(n+i)+","+
(p+k)+" "+g+","+h+" "+g+","+h);d.push("C"+g+","+h+" "+(e+i)+","+(f+k)+" "+e+","+f)}d.push("z");this.bubbleArrow_.setAttribute("d",d.join(" "))};c.Bubble.prototype.setColour=function(c){this.bubbleBack_.setAttribute("fill",c);this.bubbleArrow_.setAttribute("fill",c)};c.Bubble.prototype.destroy=function(){c.Bubble.unbindDragEvents_();this.bubbleGroup_.parentNode.removeChild(this.bubbleGroup_);this.content_=this.bubbleGroup_=null}}).call(this,Blockly);(function(c){c.Comment=function(c){this.block_=c;this.createIcon_()};c.Comment.ICON_RADIUS=8;c.Comment.prototype.bubble_=null;c.Comment.prototype.text_="";c.Comment.prototype.iconX_=null;c.Comment.prototype.iconY_=null;c.Comment.prototype.relativeLeft_=-100;c.Comment.prototype.relativeTop_=-120;c.Comment.prototype.width_=160;c.Comment.prototype.height_=80;c.Comment.prototype.createIcon_=function(){this.iconGroup_=c.createSvgElement("g",{"class":"blocklyIconGroup"},null);c.createSvgElement("circle",
{"class":"blocklyIconShield",r:c.Comment.ICON_RADIUS,cx:c.Comment.ICON_RADIUS,cy:c.Comment.ICON_RADIUS},this.iconGroup_);this.iconMark_=c.createSvgElement("text",{"class":"blocklyIconMark",x:c.Comment.ICON_RADIUS/2+0.5,y:2*c.Comment.ICON_RADIUS-3},this.iconGroup_);this.iconMark_.appendChild(c.svgDoc.createTextNode("?"));this.block_.getSvgRoot().appendChild(this.iconGroup_);c.bindEvent_(this.iconGroup_,"mouseup",this,this.iconClick_)};c.Comment.prototype.createEditor_=function(){this.foreignObject_=
c.createSvgElement("foreignObject",{x:c.Bubble.BORDER_WIDTH,y:c.Bubble.BORDER_WIDTH},null);var d=c.svgDoc.createElementNS(c.HTML_NS,"body");d.setAttribute("xmlns",c.HTML_NS);d.className="blocklyMinimalBody";this.textarea_=c.svgDoc.createElementNS(c.HTML_NS,"textarea");this.textarea_.className="blocklyCommentTextarea";this.textarea_.setAttribute("dir",c.RTL?"RTL":"LTR");d.appendChild(this.textarea_);this.foreignObject_.appendChild(d);c.bindEvent_(this.textarea_,"mouseup",this,this.textareaFocus_);
return this.foreignObject_};c.Comment.prototype.resizeBubble_=function(){var d=this.bubble_.getBubbleSize(),e=2*c.Bubble.BORDER_WIDTH;this.foreignObject_.setAttribute("width",d.width-e);this.foreignObject_.setAttribute("height",d.height-e);this.textarea_.style.width=d.width-e-4+"px";this.textarea_.style.height=d.height-e-4+"px"};c.Comment.prototype.isVisible=function(){return!!this.bubble_};c.Comment.prototype.setVisible=function(d){if(d!=this.isVisible()){var e=this.getText(),f=this.getBubbleLocation(),
g=this.getBubbleSize();d?(this.bubble_=new c.Bubble(this.block_.workspace.getBubbleCanvas(),this.createEditor_(),this.iconX_,this.iconY_,this.relativeLeft_,this.relativeTop_,this.width_,this.height_),this.bubble_.registerResizeEvent(this,this.resizeBubble_),this.updateColour(),this.text_=null):(this.bubble_.destroy(),this.foreignObject_=this.textarea_=this.bubble_=null);this.setText(e);this.setBubbleLocation(f.x,f.y);this.setBubbleSize(g.width,g.height)}};c.Comment.prototype.iconClick_=function(){this.setVisible(!this.isVisible())};
c.Comment.prototype.textareaFocus_=function(){this.bubble_.promote_();this.textarea_.focus()};c.Comment.prototype.getBubbleLocation=function(){return this.isVisible()?this.bubble_.getBubbleLocation():{x:this.relativeLeft_,y:this.relativeTop_}};c.Comment.prototype.setBubbleLocation=function(c,e){this.isVisible()?this.bubble_.setBubbleLocation(c,e):(this.relativeLeft_=c,this.relativeTop_=e)};c.Comment.prototype.getBubbleSize=function(){return this.isVisible()?this.bubble_.getBubbleSize():{width:this.width_,
height:this.height_}};c.Comment.prototype.setBubbleSize=function(c,e){this.isVisible()?this.bubble_.setBubbleSize(c,e):(this.width_=c,this.height_=e)};c.Comment.prototype.getText=function(){return this.isVisible()?this.textarea_.value:this.text_};c.Comment.prototype.setText=function(c){this.isVisible()?this.textarea_.value=c:this.text_=c};c.Comment.prototype.updateColour=function(){if(this.isVisible()){var d=c.makeColour(this.block_.getColour());this.bubble_.setColour(d)}};c.Comment.prototype.destroy=
function(){this.iconGroup_.parentNode.removeChild(this.iconGroup_);this.iconGroup_=null;this.setVisible(!1);this.block_=this.block_.comment=null};c.Comment.prototype.renderIcon=function(d){if(this.block_.collapsed)return this.iconGroup_.setAttribute("display","none"),d;this.iconGroup_.setAttribute("display","block");var e=2*c.Comment.ICON_RADIUS;c.RTL&&(d-=e);this.iconGroup_.setAttribute("transform","translate("+d+", 5)");this.computeIconLocation();return d=c.RTL?d-c.BlockSvg.SEP_SPACE_X:d+(e+c.BlockSvg.SEP_SPACE_X)};
c.Comment.prototype.setIconLocation=function(c,e){this.iconX_=c;this.iconY_=e;this.isVisible()&&this.bubble_.setAnchorLocation(c,e)};c.Comment.prototype.computeIconLocation=function(){var d=this.block_.getRelativeToSurfaceXY(),e=c.getRelativeXY_(this.iconGroup_),f=d.x+e.x+c.Comment.ICON_RADIUS,d=d.y+e.y+c.Comment.ICON_RADIUS;(f!==this.iconX_||d!==this.iconY_)&&this.setIconLocation(f,d)};c.Comment.prototype.getIconLocation=function(){return{x:this.iconX_,y:this.iconY_}}}).call(this,Blockly);(function(c){c.Connection=function(c,e){this.sourceBlock_=c;this.targetConnection=null;this.type=e;this.y_=this.x_=0;this.inDB_=!1;this.dbList_=this.sourceBlock_.workspace.connectionDBList};c.Connection.prototype.destroy=function(){if(this.targetConnection)throw"Disconnect connection before destroying it.";this.inDB_&&this.dbList_[this.type].removeConnection_(this);this.inDB_=!1;c.highlightedConnection_==this&&(c.highlightedConnection_=null);c.localConnection_==this&&(c.localConnection_=null)};c.Connection.prototype.isSuperior=
function(){return this.type==c.INPUT_VALUE||this.type==c.NEXT_STATEMENT};c.Connection.prototype.connect=function(d){if(this.sourceBlock_==d.sourceBlock_)throw"Attempted to connect a block to itself.";if(this.sourceBlock_.workspace!==d.sourceBlock_.workspace)throw"Blocks are on different workspaces.";if(c.OPPOSITE_TYPE[this.type]!=d.type)throw"Attempt to connect incompatible types.";if(this.type==c.INPUT_VALUE||this.type==c.OUTPUT_VALUE){if(this.targetConnection)throw"Source connection already connected (value).";
if(d.targetConnection){var e=d.targetBlock();e.setParent(null);for(var f=this.sourceBlock_;f=c.Connection.singleConnection_(f,e);)if(f.targetBlock())f=f.targetBlock();else{f.connect(e.outputConnection);e=null;break}e&&window.setTimeout(function(){e.outputConnection.bumpAwayFrom_(d)},c.BUMP_DELAY)}}else{if(this.targetConnection)throw"Source connection already connected (block).";if(d.targetConnection){if(this.type!=c.PREVIOUS_STATEMENT)throw"Can only do a mid-stack connection with the top of a block.";
e=d.targetBlock();e.setParent(null);for(f=this.sourceBlock_;f.nextConnection;)if(f.nextConnection.targetConnection)f=f.nextConnection.targetBlock();else{f.nextConnection.connect(e.previousConnection);e=null;break}e&&window.setTimeout(function(){e.previousConnection.bumpAwayFrom_(d)},c.BUMP_DELAY)}}var g;this.isSuperior()?(f=this.sourceBlock_,g=d.sourceBlock_):(f=d.sourceBlock_,g=this.sourceBlock_);this.targetConnection=d;d.targetConnection=this;g.setParent(f);f.rendered&&f.svg_.updateDisabled();g.rendered&&
(g.svg_.updateDisabled(),g.render())};c.Connection.singleConnection_=function(d,e){for(var f=!1,g=0;g<d.inputList.length;g++){var h=d.inputList[g].connection;if(h&&h.type==c.INPUT_VALUE&&e.outputConnection.checkType_(h)){if(f)return null;f=h}}return f};c.Connection.prototype.disconnect=function(){var c=this.targetConnection;if(c){if(c.targetConnection!=this)throw"Target connection not connected to source connection.";}else throw"Source connection not connected.";this.targetConnection=c.targetConnection=
null;var e;this.isSuperior()?(e=this.sourceBlock_,c=c.sourceBlock_):(e=c.sourceBlock_,c=this.sourceBlock_);e.rendered&&e.render();c.rendered&&(c.svg_.updateDisabled(),c.render())};c.Connection.prototype.targetBlock=function(){return this.targetConnection?this.targetConnection.sourceBlock_:null};c.Connection.prototype.bumpAwayFrom_=function(d){if(0==c.Block.dragMode_){var e=this.sourceBlock_.getRootBlock(),f=!1;if(!e.editable){e=d.sourceBlock_.getRootBlock();if(!e.editable)return;d=this;f=!0}e.getSvgRoot().parentNode.appendChild(e.getSvgRoot());
var g=d.x_+c.SNAP_RADIUS-this.x_,d=d.y_+2*c.SNAP_RADIUS-this.y_;f&&(d=-d);c.RTL&&(g=-g);e.moveBy(g,d)}};c.Connection.prototype.moveTo=function(c,e){this.inDB_&&this.dbList_[this.type].removeConnection_(this);this.x_=c;this.y_=e;this.dbList_[this.type].addConnection_(this)};c.Connection.prototype.moveBy=function(c,e){this.moveTo(this.x_+c,this.y_+e)};c.Connection.prototype.highlight=function(){var d;this.type==c.INPUT_VALUE||this.type==c.OUTPUT_VALUE?(d=c.RTL?-c.BlockSvg.TAB_WIDTH:c.BlockSvg.TAB_WIDTH,
d="m 0,0 v 5 c 0,10 "+-d+",-8 "+-d+",7.5 s "+d+",-2.5 "+d+",7.5 v 5"):d=c.RTL?"m 20,0 h -5 l -6,4 -3,0 -6,-4 h -5":"m -20,0 h 5 l 6,4 3,0 6,-4 h 5";var e=this.sourceBlock_.getRelativeToSurfaceXY();c.Connection.highlightedPath_=c.createSvgElement("path",{"class":"blocklyHighlightedConnectionPath",d:d,transform:"translate("+(this.x_-e.x)+", "+(this.y_-e.y)+")"},this.sourceBlock_.getSvgRoot())};c.Connection.prototype.unhighlight=function(){var d=c.Connection.highlightedPath_;d.parentNode.removeChild(d);
delete c.Connection.highlightedPath_};c.Connection.prototype.tighten_=function(){var d=Math.round(this.targetConnection.x_-this.x_),e=Math.round(this.targetConnection.y_-this.y_);if(0!=d||0!=e){var f=this.targetBlock(),g=c.getRelativeXY_(f.getSvgRoot());f.getSvgRoot().setAttribute("transform","translate("+(g.x-d)+", "+(g.y-e)+")");f.moveConnections_(-d,-e)}};c.Connection.prototype.closest=function(d,e,f){function g(e){var f=h[e];if((f.type==c.OUTPUT_VALUE||f.type==c.PREVIOUS_STATEMENT)&&f.targetConnection||
!n.checkType_(f))return!0;f=f.sourceBlock_;do{if(m==f)return!0;f=f.getParent()}while(f);var g=i-h[e].x_,f=k-h[e].y_,g=Math.sqrt(g*g+f*f);g<=d&&(l=h[e],d=g);return f<d}if(this.targetConnection)return{connection:null,radius:d};for(var h=this.dbList_[c.OPPOSITE_TYPE[this.type]],i=this.x_+e,k=this.y_+f,e=0,j=f=h.length-2;e<j;)h[j].y_<k?e=j:f=j,j=Math.floor((e+f)/2);var f=e=j,l=null,m=this.sourceBlock_,n=this;if(h.length){for(;0<=e&&g(e);)e--;do f++;while(f<h.length&&g(f))}return{connection:l,radius:d}};
c.Connection.prototype.checkType_=function(c){if(!this.check_||!c.check_)return!0;for(var e=0;e<this.check_.length;e++)if(-1!=c.check_.indexOf(this.check_[e]))return!0;return!1};c.Connection.prototype.setCheck=function(c){c?(c instanceof Array||(c=[c]),this.check_=c,this.targetConnection&&!this.checkType_(this.targetConnection)&&(this.isSuperior()?this.targetBlock().setParent(null):this.sourceBlock_.setParent(null),this.sourceBlock_.bumpNeighbours_())):this.check_=null;return this};c.Connection.prototype.neighbours_=
function(d){function e(c){var e=g-f[c].x_,i=h-f[c].y_;Math.sqrt(e*e+i*i)<=d&&l.push(f[c]);return i<d}for(var f=this.dbList_[c.OPPOSITE_TYPE[this.type]],g=this.x_,h=this.y_,i=0,k=f.length-2,j=k;i<j;)f[j].y_<h?i=j:k=j,j=Math.floor((i+k)/2);var k=i=j,l=[];if(f.length){for(;0<=i&&e(i);)i--;do k++;while(k<f.length&&e(k))}return l};c.Connection.prototype.hideAll=function(){this.inDB_&&this.dbList_[this.type].removeConnection_(this);if(this.targetConnection)for(var c=this.targetBlock().getDescendants(),
e=0;e<c.length;e++){for(var f=c[e],g=f.getConnections_(!0),h=0;h<g.length;h++){var i=g[h];i.inDB_&&this.dbList_[i.type].removeConnection_(i)}f.comment&&f.comment.setVisible_(!1)}};c.Connection.prototype.unhideAll=function(){this.inDB_||this.dbList_[this.type].addConnection_(this);var d=[];if(this.type!=c.INPUT_VALUE&&this.type!=c.NEXT_STATEMENT)return d;var e=this.targetBlock();if(e){var f;e.collapsed?(f=[],e.outputConnection&&f.push(e.outputConnection),e.nextConnection&&f.push(e.nextConnection),
e.previousConnection&&f.push(e.previousConnection)):f=e.getConnections_(!0);for(var g=0;g<f.length;g++)d=d.concat(f[g].unhideAll());0==d.length&&(d[0]=e);e.comment&&e.comment.isPinned()&&e.comment.setVisible_(!0)}return d};c.ConnectionDB=function(){};c.ConnectionDB.prototype=[];c.ConnectionDB.constructor=c.ConnectionDB;c.ConnectionDB.prototype.addConnection_=function(c){if(c.inDB_)throw"Connection already in database.";for(var e=0,f=this.length;e<f;){var g=Math.floor((e+f)/2);if(this[g].y_<c.y_)e=
g+1;else if(this[g].y_>c.y_)f=g;else{e=g;break}}this.splice(e,0,c);c.inDB_=!0};c.ConnectionDB.prototype.removeConnection_=function(c){if(!c.inDB_)throw"Connection not in database.";c.inDB_=!1;for(var e=0,f=this.length-2,g=f;e<g;)this[g].y_<c.y_?e=g:f=g,g=Math.floor((e+f)/2);for(f=e=g;0<=e&&this[e].y_==c.y_;){if(this[e]==c){this.splice(e,1);return}e--}do{if(this[f]==c){this.splice(f,1);return}f++}while(f<this.length&&this[f].y_==c.y_);throw"Unable to find connection in connectionDB.";};c.ConnectionDB.init=
function(d){var e=[];e[c.INPUT_VALUE]=new c.ConnectionDB;e[c.OUTPUT_VALUE]=new c.ConnectionDB;e[c.NEXT_STATEMENT]=new c.ConnectionDB;e[c.PREVIOUS_STATEMENT]=new c.ConnectionDB;d.connectionDBList=e}}).call(this,Blockly);(function(c){c.ContextMenu={};c.ContextMenu.X_PADDING=20;c.ContextMenu.Y_HEIGHT=20;c.ContextMenu.visible=!1;c.ContextMenu.createDom=function(){var d=c.createSvgElement("g",{"class":"blocklyHidden"},null);c.ContextMenu.svgGroup=d;c.ContextMenu.svgShadow=c.createSvgElement("rect",{"class":"blocklyContextMenuShadow",x:2,y:-2,rx:4,ry:4},d);c.ContextMenu.svgBackground=c.createSvgElement("rect",{"class":"blocklyContextMenuBackground",y:-4,rx:4,ry:4},d);c.ContextMenu.svgOptions=c.createSvgElement("g",{"class":"blocklyContextMenuOptions"},
d);return d};c.ContextMenu.show=function(d,e,f){if(0==f.length)c.ContextMenu.hide();else{c.removeChildren_(c.ContextMenu.svgOptions);c.ContextMenu.svgGroup.style.display="block";for(var g=0,h=[c.ContextMenu.svgBackground,c.ContextMenu.svgShadow],i=0,k;k=f[i];i++){var j=c.ContextMenu.optionToDom(k.text),l=j.firstChild,m=j.lastChild;c.ContextMenu.svgOptions.appendChild(j);j.setAttribute("transform","translate(0, "+i*c.ContextMenu.Y_HEIGHT+")");h.push(l);c.bindEvent_(j,"mousedown",null,c.noEvent);k.enabled?
(c.bindEvent_(j,"mouseup",null,k.callback),c.bindEvent_(j,"mouseup",null,c.ContextMenu.hide)):j.setAttribute("class","blocklyMenuDivDisabled");g=Math.max(g,m.getComputedTextLength())}g+=2*c.ContextMenu.X_PADDING;for(i=0;i<h.length;i++)h[i].setAttribute("width",g);if(c.RTL)for(i=0;j=c.ContextMenu.svgOptions.childNodes[i];i++)m=j.lastChild,m.setAttribute("text-anchor","end"),m.setAttribute("x",g-c.ContextMenu.X_PADDING);c.ContextMenu.svgBackground.setAttribute("height",f.length*c.ContextMenu.Y_HEIGHT+
8);c.ContextMenu.svgShadow.setAttribute("height",f.length*c.ContextMenu.Y_HEIGHT+10);e=c.mouseToSvg(d,e);d=e.x;e=e.y;f=c.ContextMenu.svgGroup.getBBox();g=c.svgSize();e+f.height>g.height&&(e-=f.height-10);c.RTL?0>=d-f.width?d++:d-=f.width:d+f.width>g.width?d-=f.width:d++;c.ContextMenu.svgGroup.setAttribute("transform","translate("+d+", "+e+")");c.ContextMenu.visible=!0}};c.ContextMenu.optionToDom=function(d){var e=c.createSvgElement("g",{"class":"blocklyMenuDiv"},null);c.createSvgElement("rect",{height:c.ContextMenu.Y_HEIGHT},
e);var f=c.createSvgElement("text",{"class":"blocklyMenuText",x:c.ContextMenu.X_PADDING,y:15},e),d=c.svgDoc.createTextNode(d);f.appendChild(d);return e};c.ContextMenu.hide=function(){c.ContextMenu.visible&&(c.ContextMenu.svgGroup.style.display="none",c.ContextMenu.visible=!1)}}).call(this,Blockly);(function(c){c.Field=function(d){null!==d&&(this.sourceBlock_=null,this.group_=c.createSvgElement("g",{},null),this.borderRect_=c.createSvgElement("rect",{rx:4,ry:4,x:-c.BlockSvg.SEP_SPACE_X/2,y:-12,height:16},this.group_),this.textElement_=c.createSvgElement("text",{"class":"blocklyText"},this.group_),this.CURSOR&&(this.group_.style.cursor=this.CURSOR),this.size_={height:25,width:0},this.setText(d))};c.Field.NBSP="\u00a0";c.Field.prototype.EDITABLE=!0;c.Field.prototype.init=function(d){if(this.sourceBlock_)throw"Field has already been initialized once.";
this.sourceBlock_=d;this.group_.setAttribute("class",d.editable?"blocklyEditableText":"blocklyNonEditableText");d.getSvgRoot().appendChild(this.group_);d.editable&&(this.mouseUpWrapper_=c.bindEvent_(this.group_,"mouseup",this,this.onMouseUp_))};c.Field.prototype.destroy=function(){this.mouseUpWrapper_&&(c.unbindEvent_(this.mouseUpWrapper_),this.mouseUpWrapper_=null);this.sourceBlock_=null;this.group_.parentNode.removeChild(this.group_);this.borderRect_=this.textElement_=this.group_=null};c.Field.prototype.setVisible=
function(c){this.getRootElement().style.display=c?"block":"none"};c.Field.prototype.getRootElement=function(){return this.group_};c.Field.textLengthCache={};c.Field.prototype.render_=function(){if(c.Field.textLengthCache.hasOwnProperty(this.text_))var d=c.Field.textLengthCache[this.text_];else d=this.textElement_.getComputedTextLength(),c.Field.textLengthCache[this.text_]=d;this.borderRect_&&this.borderRect_.setAttribute("width",d+c.BlockSvg.SEP_SPACE_X);this.size_.width=d};c.Field.prototype.getSize=
function(){this.size_.width||this.render_();return this.size_};c.Field.prototype.getText=function(){return this.text_};c.Field.prototype.setText=function(d){this.text_=d;c.removeChildren_(this.textElement_);d=d.replace(/\s/g,c.Field.NBSP);d||(d=c.Field.NBSP);d=c.svgDoc.createTextNode(d);this.textElement_.appendChild(d);this.size_.width=0;this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours_(),this.sourceBlock_.workspace.fireChangeEvent())};c.Field.prototype.getValue=
function(){return this.getText()};c.Field.prototype.setValue=function(c){this.setText(c)};c.Field.prototype.onMouseUp_=function(d){c.isRightButton(d)||2!=c.Block.dragMode_&&this.showEditor_()};c.Field.prototype.setTooltip=function(){}}).call(this,Blockly);(function(c){c.FieldDropdown=function(d,e){this.menuGenerator_=d;this.changeHandler_=e;var f=this.getOptions_()[0][0];c.Field.call(this,f)};c.FieldDropdown.prototype=new c.Field(null);c.FieldDropdown.constructor=c.FieldDropdown;c.FieldDropdown.createDom=function(){var d=c.createSvgElement("g",{"class":"blocklyHidden"},null);c.FieldDropdown.svgGroup_=d;c.FieldDropdown.svgShadow_=c.createSvgElement("rect",{"class":"blocklyDropdownMenuShadow",x:0,y:1,rx:2,ry:2},d);c.FieldDropdown.svgBackground_=c.createSvgElement("rect",
{x:-2,y:-1,rx:2,ry:2,filter:"url(#blocklyEmboss)"},d);c.FieldDropdown.svgOptions_=c.createSvgElement("g",{"class":"blocklyDropdownMenuOptions"},d);return d};c.FieldDropdown.prototype.destroy=function(){c.FieldDropdown.openDropdown_==this&&c.FieldDropdown.hideMenu();c.Field.prototype.destroy.call(this)};c.FieldDropdown.CORNER_RADIUS=2;c.FieldDropdown.prototype.CURSOR="default";c.FieldDropdown.openDropdown_=null;c.FieldDropdown.prototype.showEditor_=function(){function d(c){return function(d){this.changeHandler_?
this.changeHandler_(c):this.setText(c);d.stopPropagation()}}var e=c.FieldDropdown.svgGroup_,f=c.FieldDropdown.svgOptions_,g=c.FieldDropdown.svgBackground_,h=c.FieldDropdown.svgShadow_;c.removeChildren_(f);e.style.display="block";c.FieldDropdown.openDropdown_=this;for(var i=0,k=[],j=null,l=this.getOptions_(),m=0;m<l.length;m++){var n=l[m][0],p=c.ContextMenu.optionToDom(n),r=p.firstChild,s=p.lastChild;f.appendChild(p);!j&&n==this.text_&&(j=c.createSvgElement("text",{"class":"blocklyMenuText",y:15},
null),p.insertBefore(j,s),j.appendChild(c.svgDoc.createTextNode("\u2713")));p.setAttribute("transform","translate(0, "+m*c.ContextMenu.Y_HEIGHT+")");k.push(r);c.bindEvent_(p,"mousedown",null,c.noEvent);c.bindEvent_(p,"mouseup",this,d(n));c.bindEvent_(p,"mouseup",null,c.FieldDropdown.hideMenu);i=Math.max(i,s.getComputedTextLength())}i+=2*c.ContextMenu.X_PADDING;for(m=0;m<k.length;m++)k[m].setAttribute("width",i);if(c.RTL)for(m=0;p=f.childNodes[m];m++)s=p.lastChild,s.setAttribute("text-anchor","end"),
s.setAttribute("x",i-c.ContextMenu.X_PADDING);j&&(c.RTL?(j.setAttribute("text-anchor","end"),j.setAttribute("x",i-5)):j.setAttribute("x",5));m=i+2*c.FieldDropdown.CORNER_RADIUS;l=l.length*c.ContextMenu.Y_HEIGHT+c.FieldDropdown.CORNER_RADIUS+1;h.setAttribute("width",m);h.setAttribute("height",l);g.setAttribute("width",m);g.setAttribute("height",l);h=c.makeColour(this.sourceBlock_.getColour());g.setAttribute("fill",h);g=c.getAbsoluteXY_(this.borderRect_);h=this.borderRect_.getBBox();m=c.RTL?g.x-i+c.ContextMenu.X_PADDING+
h.width-c.BlockSvg.SEP_SPACE_X/2:g.x-c.ContextMenu.X_PADDING+c.BlockSvg.SEP_SPACE_X/2;e.setAttribute("transform","translate("+m+", "+(g.y+h.height)+")")};c.FieldDropdown.prototype.getOptions_=function(){return"function"==typeof this.menuGenerator_?this.menuGenerator_.call(this):this.menuGenerator_};c.FieldDropdown.prototype.getValue=function(){for(var c=this.text_,e=this.getOptions_(),f=0;f<e.length;f++)if(e[f][0]==c)return e[f][1];throw'"'+c+'" not valid in dropdown.';};c.FieldDropdown.prototype.setValue=
function(c){for(var e=this.getOptions_(),f=0;f<e.length;f++)if(e[f][1]==c){this.setText(e[f][0]);return}this.setText(c)};c.FieldDropdown.hideMenu=function(){c.FieldDropdown.svgGroup_.style.display="none";c.FieldDropdown.openDropdown_=null}}).call(this,Blockly);(function(c){c.FieldImage=function(d,e,f){this.sourceBlock_=null;f=Number(f);e=Number(e);this.size_={height:f+10,width:e};var g=6-c.BlockSvg.TITLE_HEIGHT;this.group_=c.createSvgElement("g",{},null);this.imageElement_=c.createSvgElement("image",{height:f+"px",width:e+"px",y:g},this.group_);this.setText(d);-1!=window.navigator.userAgent.indexOf("Gecko/")&&(this.rectElement_=c.createSvgElement("rect",{height:f+"px",width:e+"px",y:g,"fill-opacity":0},this.group_))};c.FieldImage.prototype=new c.Field(null);
c.FieldImage.constructor=c.FieldImage;c.FieldImage.prototype.rectElement_=null;c.FieldImage.prototype.EDITABLE=!1;c.FieldImage.prototype.init=function(d){if(this.sourceBlock_)throw"Image has already been initialized once.";this.sourceBlock_=d;d.getSvgRoot().appendChild(this.group_);d=this.rectElement_||this.imageElement_;d.tooltip=this.sourceBlock_;c.Tooltip&&c.Tooltip.bindMouseEvents(d)};c.FieldImage.prototype.destroy=function(){this.group_.parentNode.removeChild(this.group_);this.rectElement_=this.imageElement_=
this.group_=null};c.FieldImage.prototype.setTooltip=function(c){topElement_.tooltip=c};c.FieldImage.prototype.getText=function(){return this.src_};c.FieldImage.prototype.setText=function(c){this.src_=c;this.imageElement_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c)}}).call(this,Blockly);(function(c){c.FieldLabel=function(d){this.sourceBlock_=null;this.textElement_=c.createSvgElement("text",{"class":"blocklyText"},null);this.size_={height:25,width:0};this.setText(d)};c.FieldLabel.prototype=new c.Field(null);c.FieldLabel.constructor=c.FieldLabel;c.FieldLabel.prototype.EDITABLE=!1;c.FieldLabel.prototype.init=function(d){if(this.sourceBlock_)throw"Text has already been initialized once.";this.sourceBlock_=d;d.getSvgRoot().appendChild(this.textElement_);this.textElement_.tooltip=this.sourceBlock_;
c.Tooltip&&c.Tooltip.bindMouseEvents(this.textElement_)};c.FieldLabel.prototype.destroy=function(){this.textElement_.parentNode.removeChild(this.textElement_);this.textElement_=null};c.FieldLabel.prototype.getRootElement=function(){return this.textElement_};c.FieldLabel.prototype.setTooltip=function(c){this.textElement_.tooltip=c}}).call(this,Blockly);(function(c){c.FieldTextInput=function(d,e){c.Field.call(this,d);this.validationFunc_=e};c.FieldTextInput.prototype=new c.Field(null);c.FieldTextInput.constructor=c.FieldTextInput;c.FieldTextInput.prototype.setText=function(d){if(this.validationFunc_){var e=this.validationFunc_(d);null!==e&&(d=e)}c.Field.prototype.setText.call(this,d)};c.FieldTextInput.injectDom_=function(d){d=c.createSvgElement("foreignObject",{height:22},d);c.FieldTextInput.svgForeignObject_=d;var e=c.svgDoc.createElement("body");
e.className="blocklyMinimalBody";var f=c.svgDoc.createElement("input");f.className="blocklyHtmlInput";f.style.border="none";f.style.outline="none";c.FieldTextInput.htmlInput_=f;e.appendChild(f);d.appendChild(e)};c.FieldTextInput.destroyDom_=function(){var d=c.FieldTextInput.svgForeignObject_;d.parentNode.removeChild(d);c.FieldTextInput.svgForeignObject_=null;c.FieldTextInput.htmlInput_=null};c.FieldTextInput.prototype.CURSOR="text";c.FieldTextInput.prototype.showEditor_=function(){if(window.opera){var d=
window.prompt(c.MSG_CHANGE_VALUE_TITLE,this.text_);this.validationFunc_&&(d=this.validationFunc_(d));null!==d&&this.setText(d)}else{d=this.sourceBlock_.workspace.getCanvas();c.FieldTextInput.injectDom_(d);var e=c.FieldTextInput.htmlInput_;e.value=e.defaultValue=this.text_;e.oldValue_=null;var f=c.FieldTextInput.svgForeignObject_,g=c.getAbsoluteXY_(this.borderRect_),h=c.getAbsoluteXY_(d);g.x-=h.x;g.y-=h.y;c.RTL||f.setAttribute("x",g.x+1);-1!=window.navigator.userAgent.indexOf("Gecko/")?f.setAttribute("y",
g.y-1):f.setAttribute("y",g.y-3);e.focus();e.select();e.onBlurWrapper_=c.bindEvent_(e,"blur",this,this.onHtmlInputBlur_);e.onKeyUpWrapper_=c.bindEvent_(e,"keyup",this,this.onHtmlInputChange_);e.onKeyPressWrapper_=c.bindEvent_(e,"keypress",this,this.onHtmlInputChange_);e.onWorkspaceChangeWrapper_=c.bindEvent_(d,"blocklyWorkspaceChange",this,this.resizeEditor_);this.validate_();this.resizeEditor_()}};c.FieldTextInput.prototype.onHtmlInputBlur_=function(){this.closeEditor_(!0)};c.FieldTextInput.prototype.onHtmlInputChange_=
function(d){if(13==d.keyCode)this.closeEditor_(!0);else if(27==d.keyCode)this.closeEditor_(!1);else{var d=c.FieldTextInput.htmlInput_,e=d.value;e!==d.oldValue_&&(d.oldValue_=e,this.setText(e),this.validate_())}};c.FieldTextInput.prototype.validate_=function(){var d=!0,e=c.FieldTextInput.htmlInput_;this.validationFunc_&&(d=this.validationFunc_(e.value));d?c.removeClass_(e,"blocklyInvalidInput"):c.addClass_(e,"blocklyInvalidInput")};c.FieldTextInput.prototype.resizeEditor_=function(){var d=c.FieldTextInput.htmlInput_,
e=this.group_.getBBox(),f=c.FieldTextInput.svgForeignObject_;f.setAttribute("width",e.width);d.style.width=e.width-2+"px";d=c.getAbsoluteXY_(this.group_);e=this.sourceBlock_.workspace.getCanvas();e=c.getAbsoluteXY_(e);d.x-=e.x;f.setAttribute("x",d.x-4)};c.FieldTextInput.prototype.closeEditor_=function(d){var e=c.FieldTextInput.htmlInput_;c.unbindEvent_(e.onBlurWrapper_);c.unbindEvent_(e.onKeyUpWrapper_);c.unbindEvent_(e.onKeyPressWrapper_);c.unbindEvent_(e.onWorkspaceChangeWrapper_);d?(d=e.value,
this.validationFunc_&&(d=this.validationFunc_(d),null===d&&(d=e.defaultValue))):d=e.defaultValue;this.setText(d);c.FieldTextInput.destroyDom_();this.sourceBlock_.render()}}).call(this,Blockly);(function(c){c.FieldVariable=function(d){c.FieldDropdown.call(this,c.FieldVariable.dropdownCreate,c.FieldVariable.dropdownChange);d?this.setText(d):this.setText(c.Variables.generateUniqueName())};c.FieldVariable.prototype=new c.FieldDropdown([[null]]);c.FieldVariable.constructor=c.FieldVariable;c.FieldVariable.prototype.getValue=function(){return this.getText()};c.FieldVariable.prototype.setValue=function(c){this.setText(c)};c.FieldVariable.dropdownCreate=function(){var d=c.Variables.allVariables(),
e=this.getText();e&&-1==d.indexOf(e)&&d.push(e);d.sort(c.caseInsensitiveComparator);d.push(c.MSG_RENAME_VARIABLE);d.push(c.MSG_NEW_VARIABLE);for(var e=[],f=0;f<d.length;f++)e[f]=[d[f],d[f]];return e};c.FieldVariable.dropdownChange=function(d){function e(d,e){c.hideChaff();var f=window.prompt(d,e);return f&&f.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")}if(d==c.MSG_RENAME_VARIABLE){var f=this.getText();(d=e(c.MSG_RENAME_VARIABLE_TITLE.replace("%1",f),f))&&c.Variables.renameVariable(f,d)}else d==
c.MSG_NEW_VARIABLE&&(d=e(c.MSG_NEW_VARIABLE_TITLE,""),c.Variables.renameVariable(d,d)),d&&this.setText(d);window.setTimeout(c.Variables.refreshFlyoutCategory,1)}}).call(this,Blockly);(function(c){c.Flyout=function(){this.workspace_=new c.Workspace(!1)};c.Flyout.prototype.autoClose=!0;c.Flyout.prototype.CORNER_RADIUS=8;c.Flyout.prototype.onResizeWrapper_=null;c.Flyout.prototype.createDom=function(){this.svgGroup_=c.createSvgElement("g",{},null);this.svgBackground_=c.createSvgElement("path",{"class":"blocklyFlyoutBackground"},this.svgGroup_);this.svgOptions_=c.createSvgElement("g",{},this.svgGroup_);this.svgOptions_.appendChild(this.workspace_.createDom());return this.svgGroup_};
c.Flyout.prototype.destroy=function(){this.onResizeWrapper_&&(c.unbindEvent_(this.onResizeWrapper_),this.onResizeWrapper_=null);this.scrollbar_&&(this.scrollbar_.destroy(),this.scrollbar_=null);this.workspace_=null;this.svgGroup_&&(this.svgGroup_.parentNode.removeChild(this.svgGroup_),this.svgGroup_=null);this.buttons_=this.targetWorkspaceMetrics_=this.targetWorkspace_=this.svgOptions_=this.svgBackground_=null};c.Flyout.prototype.getMetrics=function(){if(!this.isVisible())return null;var c=this.height_-
2*this.CORNER_RADIUS,e=this.width_;try{var f=this.svgOptions_.getBBox()}catch(g){f={height:0,y:0}}return{viewHeight:c,viewWidth:e,contentHeight:f.height+f.y,viewTop:-this.svgOptions_.scrollY,contentTop:0,absoluteTop:this.CORNER_RADIUS,absoluteLeft:0}};c.Flyout.prototype.setMetrics=function(c){var e=this.getMetrics();"number"==typeof c.y&&(this.svgOptions_.scrollY=-e.contentHeight*c.y-e.contentTop);this.svgOptions_.setAttribute("transform","translate(0,"+(this.svgOptions_.scrollY+e.absoluteTop)+")")};
c.Flyout.prototype.init=function(d,e,f){this.targetWorkspace_=d;this.targetWorkspaceMetrics_=e;this.height_=this.width_=0;var g=this;f&&(this.scrollbar_=new c.Scrollbar(this.svgOptions_,function(){return g.getMetrics()},function(c){return g.setMetrics(c)},!1,!1));this.buttons_=[];this.position_();this.hide();this.onResizeWrapper_=c.bindEvent_(window,"resize",this,this.position_)};c.Flyout.prototype.position_=function(){var d=this.targetWorkspaceMetrics_();if(d){var e=this.width_-this.CORNER_RADIUS;
c.RTL&&(e*=-1);var f=["M "+(c.RTL?this.width_:0)+",0"];f.push("h",e);f.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,c.RTL?0:1,c.RTL?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS);f.push("v",Math.max(0,d.viewHeight-2*this.CORNER_RADIUS));f.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,c.RTL?0:1,c.RTL?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS);f.push("h",-e);f.push("z");this.svgBackground_.setAttribute("d",f.join(" "));e=d.absoluteLeft;c.RTL&&(e-=this.width_);
this.svgGroup_.setAttribute("transform","translate("+e+","+d.absoluteTop+")");this.height_=d.viewHeight}};c.Flyout.prototype.isVisible=function(){return"none"!=this.svgGroup_.style.display};c.Flyout.prototype.hide=function(){this.svgGroup_.style.display="none";for(var d=this.workspace_.getTopBlocks(!1),e=0,f;f=d[e];e++)f.destroy(!1,!1);for(e=0;d=this.buttons_[e];e++)c.unbindEvent_(d.wrapper_),d.parentNode.removeChild(d);this.buttons_=[]};c.Flyout.prototype.show=function(d){var e=this.CORNER_RADIUS;
this.svgGroup_.style.display="block";var f=[],g=[];if(d==c.MSG_VARIABLE_CATEGORY)c.Variables.flyoutCategory(f,g,e,this.workspace_);else if(d==c.MSG_PROCEDURE_CATEGORY)c.Procedures.flyoutCategory(f,g,e,this.workspace_);else for(var h=0,i;i=d[h];h++)i=new c.Block(this.workspace_,i),i.initSvg(),f[h]=i,g[h]=2*e;for(var d=0,k=e,h=0;i=f[h];h++){i.isInFlyout=!0;c.Comment&&i.setCommentText(null);i.render();var j=i.getSvgRoot().getBBox();i.moveBy(c.RTL?0:e+c.BlockSvg.TAB_WIDTH,k);d=Math.max(d,j.width);k+=
j.height+g[h];c.bindEvent_(i.getSvgRoot(),"mousedown",null,c.Flyout.createBlockFunc_(this,i))}d+=e+c.BlockSvg.TAB_WIDTH+e/2+c.Scrollbar.scrollbarThickness;for(h=0;i=f[h];h++)c.RTL&&i.moveBy(d-e-c.BlockSvg.TAB_WIDTH,0),j=i.getSvgRoot().getBBox(),g=i.getRelativeToSurfaceXY(),g=c.createSvgElement("rect",{width:j.width,height:j.height,x:g.x+j.x,y:g.y+j.y,"fill-opacity":0},null),this.svgOptions_.insertBefore(g,this.svgOptions_.firstChild),g.wrapper_=c.bindEvent_(g,"mousedown",null,c.Flyout.createBlockFunc_(this,
i)),this.buttons_[h]=g;this.width_=d;c.fireUiEvent(window,"resize")};c.Flyout.createBlockFunc_=function(d,e){return function(f){if(!c.isRightButton(f)){var g=c.Xml.blockToDom_(e),g=c.Xml.domToBlock_(d.targetWorkspace_,g),h=c.getAbsoluteXY_(e.getSvgRoot()),i=c.getAbsoluteXY_(d.targetWorkspace_.getCanvas());g.moveBy(h.x-i.x,h.y-i.y);g.render();d.autoClose&&d.hide();g.onMouseDown_(f)}}}}).call(this,Blockly);(function(c){c.Generator={};c.Generator.NAME_TYPE="generated_function";c.Generator.languages={};c.Generator.get=function(d){if(!(d in c.Generator.languages)){var e=new c.CodeGenerator;c.Generator.languages[d]=e}return c.Generator.languages[d]};c.Generator.workspaceToCode=function(d){var e=[],d=c.Generator.get(d);d.init();for(var f=c.mainWorkspace.getTopBlocks(!0),g=0,h;h=f[g];g++){var i=d.blockToCode(h,!0);i instanceof Array&&(i=i[0]);i&&(h.outputConnection&&d.scrubNakedValue&&(i=d.scrubNakedValue(i)),
e.push(i))}e=e.join("\n");e=d.finish(e);e=e.replace(/^\s+\n/,"");e=e.replace(/\n\s+$/,"\n");return e=e.replace(/[ \t]+\n/g,"\n")};c.Generator.prefixLines=function(c,e){return e+c.replace(/\n(.)/g,"\n"+e+"$1")};c.Generator.allNestedComments=function(c){for(var e=[],c=c.getDescendants(),f=0;f<c.length;f++){var g=c[f].getCommentText();g&&e.push(g)}e.length&&e.push("");return e.join("\n")};c.CodeGenerator=function(){};c.CodeGenerator.prototype.blockToCode=function(c){if(!c||c.disabled)return"";var e=
this[c.type];if(!e)throw'Language "'+name+'" does not know how to generate code for block type "'+c.type+'".';e=e.call(c);return e instanceof Array?[this.scrub_(c,e[0]),e[1]]:this.scrub_(c,e)};c.CodeGenerator.prototype.valueToCode=function(c,e,f){e=c.getInputTargetBlock(e);if(!e)return"";c=this.blockToCode(e);if(""===c)return"";if(!(c instanceof Array))throw'Expecting tuple from value block "'+e.type+'".';e=c[0];c=c[1];e&&f<=c&&(e="("+e+")");return e};c.CodeGenerator.prototype.statementToCode=function(d,
e){var f=d.getInputTargetBlock(e),g=this.blockToCode(f);if("string"!=typeof g)throw'Expecting code from statement block "'+f.type+'".';g&&(g=c.Generator.prefixLines(g,"  "));return g}}).call(this,Blockly);(function(c){c.inject=function(d,e){e&&c.parseOptions_(e);c.createDom_(d);c.init_()};c.parseOptions_=function(d){c.RTL=!!d.rtl;c.editable=!d.readOnly;c.pathToBlockly=d.path||"./"};c.createDom_=function(d){for(var e=d;e.parentNode;)e=e.parentNode;c.svgDoc=e;var f=e.createElement("link");f.setAttribute("href",c.pathToBlockly+"blockly.css");f.setAttribute("rel","stylesheet");f.setAttribute("type","text/css");f.setAttribute("onload","Blockly.cssLoaded()");e=e.head||e.getElementsByTagName("head")[0];if(!e)throw"No head in document.";
e.appendChild(f);var f=c.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1","class":"blocklySvg"},null),e=c.createSvgElement("defs",{},f),g,h;g=c.createSvgElement("filter",{id:"blocklyEmboss"},e);c.createSvgElement("feGaussianBlur",{"in":"SourceAlpha",stdDeviation:1,result:"blur"},g);h=c.createSvgElement("feSpecularLighting",{"in":"blur",surfaceScale:1,specularConstant:0.5,specularExponent:10,
"lighting-color":"white",result:"specOut"},g);c.createSvgElement("fePointLight",{x:-5E3,y:-1E4,z:2E4},h);c.createSvgElement("feComposite",{"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},g);c.createSvgElement("feComposite",{"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},g);g=c.createSvgElement("filter",{id:"blocklyTrashcanShadowFilter"},e);c.createSvgElement("feGaussianBlur",{"in":"SourceAlpha",stdDeviation:2,result:"blur"},g);c.createSvgElement("feOffset",
{"in":"blur",dx:1,dy:1,result:"offsetBlur"},g);g=c.createSvgElement("feMerge",{},g);c.createSvgElement("feMergeNode",{"in":"offsetBlur"},g);c.createSvgElement("feMergeNode",{"in":"SourceGraphic"},g);g=c.createSvgElement("filter",{id:"blocklyShadowFilter"},e);c.createSvgElement("feGaussianBlur",{stdDeviation:2},g);e=c.createSvgElement("pattern",{id:"blocklyDisabledPattern",patternUnits:"userSpaceOnUse",width:10,height:10},e);c.createSvgElement("rect",{width:10,height:10,fill:"#aaa"},e);c.createSvgElement("path",
{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e);c.mainWorkspace=new c.Workspace(c.editable);f.appendChild(c.mainWorkspace.createDom());c.Toolbox&&c.editable&&f.appendChild(c.Toolbox.createDom());c.Tooltip&&f.appendChild(c.Tooltip.createDom());c.editable&&f.appendChild(c.FieldDropdown.createDom());c.ContextMenu&&f.appendChild(c.ContextMenu.createDom());d.appendChild(f);c.svg=f;c.svgResize()};c.init_=function(){var d=c.svgDoc;c.bindEvent_(window,"resize",d,c.svgResize);c.bindEvent_(c.svg,"mousedown",
null,c.onMouseDown_);c.bindEvent_(d,"mouseup",null,c.onMouseUp_);c.bindEvent_(c.svg,"mousemove",null,c.onMouseMove_);c.bindEvent_(c.svg,"contextmenu",null,c.onContextMenu_);c.bindEvent_(d,"keydown",null,c.onKeyDown_);c.editable&&c.Toolbox&&c.Toolbox.init();c.mainWorkspace.addTrashcan(c.getMainWorkspaceMetrics);c.mainWorkspace.scrollbar=new c.ScrollbarPair(c.mainWorkspace.getBubbleCanvas(),c.getMainWorkspaceMetrics,this.setMainWorkspaceMetrics);c.loadAudio_("click");c.loadAudio_("delete")}}).call(this,
Blockly);(function(c){c.Input=function(d,e,f,g){this.type=d;this.name=e;this.sourceBlock_=f;this.connection=g;this.titleRow=[];this.align=c.ALIGN_LEFT};c.Input.prototype.appendTitle=function(d,e){"string"==typeof d&&(d=new c.FieldLabel(d));this.sourceBlock_.svg_&&d.init(this.sourceBlock_);d.name=e;this.titleRow.push(d);this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours_());return this};c.Input.prototype.setCheck=function(c){if(!this.connection)throw"This input does not have a connection.";
this.connection.setCheck(c);return this};c.Input.prototype.setAlign=function(c){this.align=c;this.sourceBlock_.rendered&&this.sourceBlock_.render();return this};c.Input.prototype.init=function(){for(var c=0;c<this.titleRow.length;c++)this.titleRow[c].init(this.sourceBlock_)};c.Input.prototype.destroy=function(){for(var c=0,e;e=this.titleRow[c];c++)e.destroy();this.connection&&this.connection.destroy();this.sourceBlock_=null}}).call(this,Blockly);(function(c){c.Mutator=function(c){this.block_=null;this.quarkNames_=c};c.Mutator.ICON_SIZE=16;c.Mutator.prototype.bubble_=null;c.Mutator.prototype.iconX_=null;c.Mutator.prototype.iconY_=null;c.Mutator.prototype.relativeLeft_=-180;c.Mutator.prototype.relativeTop_=-230;c.Mutator.prototype.workspaceWidth_=0;c.Mutator.prototype.workspaceHeight_=0;c.Mutator.prototype.createIcon=function(){var d=c.Mutator.ICON_SIZE/8;this.iconGroup_=c.createSvgElement("g",{},null);this.block_.editable&&this.iconGroup_.setAttribute("class",
"blocklyIconGroup");c.createSvgElement("rect",{"class":"blocklyIconShield",width:8*d,height:8*d,rx:2*d,ry:2*d},this.iconGroup_);if(!c.Mutator.crossPath_){var e=[];e.push("M",3.5*d+","+3.5*d);e.push("v",-2*d,"h",d);e.push("v",2*d,"h",2*d);e.push("v",d,"h",-2*d);e.push("v",2*d,"h",-d);e.push("v",-2*d,"h",-2*d);e.push("v",-d,"z");c.Mutator.crossPath_=e.join(" ")}this.iconMark_=c.createSvgElement("path",{"class":"blocklyIconMark",d:c.Mutator.crossPath_},this.iconGroup_);this.block_.getSvgRoot().appendChild(this.iconGroup_);
this.block_.editable&&c.bindEvent_(this.iconGroup_,"mouseup",this,this.iconClick_)};c.Mutator.prototype.createEditor_=function(){this.svgDialog_=c.createSvgElement("svg",{x:c.Bubble.BORDER_WIDTH,y:c.Bubble.BORDER_WIDTH},null);this.svgBackground_=c.createSvgElement("rect",{"class":"blocklyMutatorBackground",height:"100%",width:"100%"},this.svgDialog_);this.workspace_=new c.Workspace(!0);this.flyout_=new c.Flyout;this.flyout_.autoClose=!1;this.svgDialog_.appendChild(this.flyout_.createDom());this.svgDialog_.appendChild(this.workspace_.createDom());
return this.svgDialog_};c.Mutator.prototype.resizeBubble_=function(){var d=2*c.Bubble.BORDER_WIDTH,e=this.workspace_.getCanvas().getBBox(),f=this.flyout_.getMetrics(),g;g=c.RTL?-e.x:e.width+e.x;e=Math.max(e.height+3*d,f.contentHeight+20);g+=3*d;if(Math.abs(this.workspaceWidth_-g)>d||Math.abs(this.workspaceHeight_-e)>d)this.workspaceWidth_=g,this.workspaceHeight_=e,this.bubble_.setBubbleSize(g+d,e+d),this.svgDialog_.setAttribute("width",this.workspaceWidth_),this.svgDialog_.setAttribute("height",this.workspaceHeight_);
c.RTL&&(d="translate("+this.workspaceWidth_+",0)",this.workspace_.getCanvas().setAttribute("transform",d))};c.Mutator.prototype.isVisible=function(){return!!this.bubble_};c.Mutator.prototype.setVisible=function(d){if(d!=this.isVisible()){var e=this.getBubbleLocation();if(d){this.bubble_=new c.Bubble(this.block_.workspace.getBubbleCanvas(),this.createEditor_(),this.iconX_,this.iconY_,this.relativeLeft_,this.relativeTop_,null,null);var f=this;this.flyout_.init(this.workspace_,function(){return f.getFlyoutMetrics_()},
!1);this.flyout_.show(this.quarkNames_);this.rootBlock_=this.block_.decompose(this.workspace_);for(var d=this.rootBlock_.getDescendants(),g=0,h;h=d[g];g++)h.render();this.rootBlock_.editable=!1;d=2*this.flyout_.CORNER_RADIUS;g=this.flyout_.width_+d;c.RTL&&(g=-g);this.rootBlock_.moveBy(g,d);this.block_.saveConnections&&(this.block_.saveConnections(this.rootBlock_),this.sourceListener_=c.bindEvent_(this.block_.workspace.getCanvas(),"blocklyWorkspaceChange",this.block_,function(){f.block_.saveConnections(f.rootBlock_)}));
this.resizeBubble_();c.bindEvent_(this.workspace_.getCanvas(),"blocklyWorkspaceChange",this.block_,function(){f.workspaceChanged_()});this.updateColour()}else this.svgBackground_=this.svgDialog_=null,this.flyout_.destroy(),this.flyout_=null,this.workspace_.destroy(),this.rootBlock_=this.workspace_=null,this.bubble_.destroy(),this.bubble_=null,this.workspaceHeight_=this.workspaceWidth_=0,this.sourceListener_&&(c.unbindEvent_(this.sourceListener_),this.sourceListener_=null);this.setBubbleLocation(e.x,
e.y)}};c.Mutator.prototype.workspaceChanged_=function(){if(0==c.Block.dragMode_)for(var d=this.workspace_.getTopBlocks(!1),e=0,f;f=d[e];e++){var g=f.getRelativeToSurfaceXY();(0>g.y||(c.RTL?g.x>-this.flyout_.width_:g.x<this.flyout_.width_))&&f.destroy(!1,!1)}this.rootBlock_.workspace==this.workspace_&&(this.resizeBubble_(),d=this.block_.rendered,this.block_.rendered=!1,this.block_.compose(this.rootBlock_),this.block_.rendered=d,this.block_.rendered&&this.block_.render(),this.block_.workspace.fireChangeEvent())};
c.Mutator.prototype.getFlyoutMetrics_=function(){var d=0;c.RTL&&(d+=this.workspaceWidth_);return{viewHeight:this.workspaceHeight_,absoluteTop:0,absoluteLeft:d}};c.Mutator.prototype.iconClick_=function(){this.setVisible(!this.isVisible())};c.Mutator.prototype.getBubbleLocation=function(){return this.isVisible()?this.bubble_.getBubbleLocation():{x:this.relativeLeft_,y:this.relativeTop_}};c.Mutator.prototype.setBubbleLocation=function(c,e){this.isVisible()?this.bubble_.setBubbleLocation(c,e):(this.relativeLeft_=
c,this.relativeTop_=e)};c.Mutator.prototype.updateColour=function(){if(this.isVisible()){var d=c.makeColour(this.block_.getColour());this.bubble_.setColour(d)}};c.Mutator.prototype.destroy=function(){this.iconGroup_.parentNode.removeChild(this.iconGroup_);this.iconGroup_=null;this.setVisible(!1);this.block_=this.block_.mutator=null};c.Mutator.prototype.renderIcon=function(d){if(this.block_.collapsed)return this.iconGroup_.setAttribute("display","none"),d;this.iconGroup_.setAttribute("display","block");
c.RTL&&(d-=c.Mutator.ICON_SIZE);this.iconGroup_.setAttribute("transform","translate("+d+", 5)");this.computeIconLocation();return d=c.RTL?d-c.BlockSvg.SEP_SPACE_X:d+(c.Mutator.ICON_SIZE+c.BlockSvg.SEP_SPACE_X)};c.Mutator.prototype.setIconLocation=function(c,e){this.iconX_=c;this.iconY_=e;this.isVisible()&&this.bubble_.setAnchorLocation(c,e)};c.Mutator.prototype.computeIconLocation=function(){var d=this.block_.getRelativeToSurfaceXY(),e=c.getRelativeXY_(this.iconGroup_),f=d.x+e.x+c.Mutator.ICON_SIZE/
2,d=d.y+e.y+c.Mutator.ICON_SIZE/2;(f!==this.iconX_||d!==this.iconY_)&&this.setIconLocation(f,d)};c.Mutator.prototype.getIconLocation=function(){return{x:this.iconX_,y:this.iconY_}}}).call(this,Blockly);(function(c){c.Names=function(d){this.reservedDict_={};if(d)for(var d=d.split(","),e=0;e<d.length;e++)this.reservedDict_[c.Names.PREFIX_+d[e]]=!0;this.reset()};c.Names.PREFIX_="v_";c.Names.prototype.reset=function(){this.db_={};this.dbReverse_={}};c.Names.prototype.getName=function(d,e){var f=c.Names.PREFIX_+d.toLowerCase()+"X"+e;return f in this.db_?this.db_[f]:this.getDistinctName(d,e)};c.Names.prototype.getDistinctName=function(d,e){for(var f=this.safeName_(d),g="";this.dbReverse_[c.Names.PREFIX_+
f+g]||c.Names.PREFIX_+f+g in this.reservedDict_;)g=g?g+1:2;f+=g;this.db_[c.Names.PREFIX_+d.toLowerCase()+"X"+e]=f;this.dbReverse_[c.Names.PREFIX_+f]=!0;return f};c.Names.prototype.safeName_=function(c){c?(c=encodeURI(c.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(c.charAt(0))&&(c="my_"+c)):c="unnamed";return c};c.Names.equals=function(c,e){return c.toLowerCase()==e.toLowerCase()}}).call(this,Blockly);(function(c){c.Procedures={};c.Procedures.NAME_TYPE="procedure";c.Procedures.allProcedures=function(){function d(c,d){a=c[0].toLowerCase();b=d[0].toLowerCase();return a>b?1:a<b?-1:0}for(var e=c.mainWorkspace.getAllBlocks(!1),f=[],g=[],h=0;h<e.length;h++){var i=e[h].getProcedureDef;i&&(i=i.call(e[h]))&&(i[2]?f.push(i):g.push(i))}g.sort(d);f.sort(d);return[g,f]};c.Procedures.findLegalName=function(d,e){if(!e.workspace.editable)return d;for(;!c.Procedures.isLegalName(d,e.workspace,e);)var f=d.match(/^(.*?)(\d+)$/),
d=f?f[1]+(parseInt(f[2],10)+1):d+"2";return d};c.Procedures.isLegalName=function(d,e,f){for(var e=e.getAllBlocks(!1),g=0;g<e.length;g++)if(e[g]!=f){var h=e[g].getProcedureDef;if(h&&(h=h.call(e[g]),c.Names.equals(h[0],d)))return!1}return!0};c.Procedures.rename=function(d){if(!this.sourceBlock_.editable)return d;d=d.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"");if(!d)return null;for(var d=c.Procedures.findLegalName(d,this.sourceBlock_),e=this.sourceBlock_.workspace.getAllBlocks(!1),f=0;f<e.length;f++){var g=
e[f].renameProcedure;g&&g.call(e[f],this.text_,d)}window.setTimeout(c.Procedures.refreshFlyoutCategory,1);return d};c.Procedures.flyoutCategory=function(d,e,f,g){function h(h,i){for(var l=0;l<h.length;l++){var m=new c.Block(g,i);m.setTitleValue(h[l][0],"NAME");for(var n=[],p=0;p<h[l][1].length;p++)n[p]="ARG"+p;m.setProcedureParameters(h[l][1],n);m.initSvg();d.push(m);e.push(2*f)}}if(c.Language.procedures_defnoreturn){var i=new c.Block(g,"procedures_defnoreturn");i.initSvg();d.push(i);e.push(2*f)}c.Language.procedures_defreturn&&
(i=new c.Block(g,"procedures_defreturn"),i.initSvg(),d.push(i),e.push(2*f));i=c.Procedures.allProcedures();h(i[0],"procedures_callnoreturn");h(i[1],"procedures_callreturn")};c.Procedures.refreshFlyoutCategory=function(){c.Toolbox&&(c.Toolbox.flyout_.isVisible()&&c.Toolbox.selectedOption_.cat==c.MSG_PROCEDURE_CATEGORY)&&(c.Toolbox.flyout_.hide(),c.Toolbox.flyout_.show(c.MSG_PROCEDURE_CATEGORY))};c.Procedures.getCallers=function(d,e){for(var f=[],g=e.getAllBlocks(!1),h=0;h<g.length;h++){var i=g[h].getProcedureCall;
i&&(i=i.call(g[h]))&&c.Names.equals(i,d)&&f.push(g[h])}return f};c.Procedures.destroyCallers=function(d,e){for(var f=c.Procedures.getCallers(d,e),g=0;g<f.length;g++)f[g].destroy(!0,!1);window.setTimeout(c.Procedures.refreshFlyoutCategory,1)};c.Procedures.mutateCallers=function(d,e,f,g){d=c.Procedures.getCallers(d,e);for(e=0;e<d.length;e++)d[e].setProcedureParameters(f,g)}}).call(this,Blockly);(function(c){c.ScrollbarPair=function(d,e,f){this.element_=d;this.getMetrics_=e;this.setMetrics_=f;this.oldHostMetrics_={};this.hScroll=new c.Scrollbar(d,e,f,!0,!0);this.vScroll=new c.Scrollbar(d,e,f,!1,!0);this.corner_=this.addCorner_(d);this.resize();var g=this;this.onResizeWrapper_=c.bindEvent_(window,"resize",g,function(){g.resize()})};c.ScrollbarPair.prototype.destroy=function(){c.unbindEvent_(this.onResizeWrapper_);this.onResizeWrapper_=null;this.corner_.parentNode.removeChild(this.corner_);
this.oldHostMetrics_=this.setMetrics_=this.getMetrics_=this.element_=this.corner_=null;this.hScroll.destroy();this.hScroll=null;this.vScroll.destroy();this.vScroll=null};c.ScrollbarPair.prototype.addCorner_=function(d){var e=c.createSvgElement("rect",{height:c.Scrollbar.scrollbarThickness,width:c.Scrollbar.scrollbarThickness,style:"fill: #fff"},null);c.Scrollbar.insertAfter_(e,d);return e};c.ScrollbarPair.prototype.resize=function(){var c=this.getMetrics_();if(c){var d=!1,e=!1;if(this.oldHostMetrics_.viewWidth!=
c.viewWidth||this.oldHostMetrics_.viewHeight!=c.viewHeight||this.oldHostMetrics_.absoluteTop!=c.absoluteTop||this.oldHostMetrics_.absoluteLeft!=c.absoluteLeft)e=d=!0;else{if(this.oldHostMetrics_.contentWidth!=c.contentWidth||this.oldHostMetrics_.viewLeft!=c.viewLeft||this.oldHostMetrics_.contentLeft!=c.contentLeft)d=!0;if(this.oldHostMetrics_.contentHeight!=c.contentHeight||this.oldHostMetrics_.viewTop!=c.viewTop||this.oldHostMetrics_.contentTop!=c.contentTop)e=!0}d&&this.hScroll.resize(c);e&&this.vScroll.resize(c);
(this.oldHostMetrics_.viewWidth!=c.viewWidth||this.oldHostMetrics_.absoluteLeft!=c.absoluteLeft)&&this.corner_.setAttribute("x",this.vScroll.xCoordinate);(this.oldHostMetrics_.viewHeight!=c.viewHeight||this.oldHostMetrics_.absoluteTop!=c.absoluteTop)&&this.corner_.setAttribute("y",this.hScroll.yCoordinate);this.oldHostMetrics_=c}};c.ScrollbarPair.prototype.set=function(d,e){if(c.Scrollbar===c.ScrollbarNative){this.hScroll.set(d,!1);this.vScroll.set(e,!1);var f={};f.x=this.hScroll.outerDiv_.scrollLeft/
this.hScroll.innerImg_.offsetWidth||0;f.y=this.vScroll.outerDiv_.scrollTop/this.vScroll.innerImg_.offsetHeight||0;this.setMetrics_(f)}else this.hScroll.set(d,!0),this.vScroll.set(e,!0)};c.ScrollbarNative=function(d,e,f,g,l){this.element_=d;this.getMetrics_=e;this.setMetrics_=f;this.pair_=l||!1;this.horizontal_=g;this.createDom_(d);if(null!==g){c.ScrollbarNative.scrollbarThickness||c.ScrollbarNative.measureScrollbarThickness_(d);g?(this.foreignObject_.setAttribute("height",c.ScrollbarNative.scrollbarThickness),
this.outerDiv_.style.height=c.ScrollbarNative.scrollbarThickness+"px",this.outerDiv_.style.overflowX="scroll",this.outerDiv_.style.overflowY="hidden",this.innerImg_.style.height="1px"):(this.foreignObject_.setAttribute("width",c.ScrollbarNative.scrollbarThickness),this.outerDiv_.style.width=c.ScrollbarNative.scrollbarThickness+"px",this.outerDiv_.style.overflowX="hidden",this.outerDiv_.style.overflowY="scroll",this.innerImg_.style.width="1px");var m=this;this.onScrollWrapper_=c.bindEvent_(this.outerDiv_,
"scroll",m,function(){m.onScroll_()});c.bindEvent_(this.foreignObject_,"mousedown",null,c.noEvent);this.pair_||(this.resize(),this.onResizeWrapper_=c.bindEvent_(window,"resize",m,function(){m.resize()}))}};c.ScrollbarNative.prototype.destroy=function(){c.unbindEvent_(this.onResizeWrapper_);this.onResizeWrapper_=null;c.unbindEvent_(this.onScrollWrapper_);this.onScrollWrapper_=null;this.foreignObject_.parentNode.removeChild(this.foreignObject_);this.innerImg_=this.outerDiv_=this.setMetrics_=this.getMetrics_=
this.element_=this.foreignObject_=null};c.ScrollbarNative.prototype.resize=function(d){if(!d&&(d=this.getMetrics_(),!d))return;if(this.horizontal_){var e=d.viewWidth;this.pair_?e-=c.ScrollbarNative.scrollbarThickness:this.setVisible(e<d.contentHeight);this.ratio_=e/d.viewWidth;var f=this.ratio_*d.contentWidth,g=(d.viewLeft-d.contentLeft)*this.ratio_;this.outerDiv_.style.width=e+"px";this.innerImg_.style.width=f+"px";this.xCoordinate=d.absoluteLeft;this.pair_&&c.RTL&&(this.xCoordinate+=c.ScrollbarNative.scrollbarThickness);
this.yCoordinate=d.absoluteTop+d.viewHeight-c.ScrollbarNative.scrollbarThickness;this.foreignObject_.setAttribute("x",this.xCoordinate);this.foreignObject_.setAttribute("y",this.yCoordinate);this.foreignObject_.setAttribute("width",Math.max(0,e));this.outerDiv_.scrollLeft=Math.round(g)}else e=d.viewHeight,this.pair_?e-=c.ScrollbarNative.scrollbarThickness:this.setVisible(e<d.contentHeight),this.ratio_=e/d.viewHeight,f=this.ratio_*d.contentHeight,g=(d.viewTop-d.contentTop)*this.ratio_,this.outerDiv_.style.height=
e+"px",this.innerImg_.style.height=f+"px",this.xCoordinate=d.absoluteLeft,c.RTL||(this.xCoordinate+=d.viewWidth-c.ScrollbarNative.scrollbarThickness),this.yCoordinate=d.absoluteTop,this.foreignObject_.setAttribute("x",this.xCoordinate),this.foreignObject_.setAttribute("y",this.yCoordinate),this.foreignObject_.setAttribute("height",Math.max(0,e)),this.outerDiv_.scrollTop=Math.round(g)};c.ScrollbarNative.prototype.createDom_=function(d){this.foreignObject_=c.createSvgElement("foreignObject",{},null);
var e=c.svgDoc.createElementNS(c.HTML_NS,"body");e.setAttribute("xmlns",c.HTML_NS);e.setAttribute("class","blocklyMinimalBody");var f=c.svgDoc.createElementNS(c.HTML_NS,"div");this.outerDiv_=f;var g=c.svgDoc.createElementNS(c.HTML_NS,"img");g.setAttribute("src",c.pathToBlockly+"1x1.gif");this.innerImg_=g;f.appendChild(g);e.appendChild(f);this.foreignObject_.appendChild(e);c.Scrollbar.insertAfter_(this.foreignObject_,d)};c.ScrollbarNative.prototype.isVisible=function(){return"none"!=this.foreignObject_.style.display};
c.ScrollbarNative.prototype.setVisible=function(c){if(c!=this.isVisible()){if(this.pair_)throw"Unable to toggle visibility of paired scrollbars.";c?(this.foreignObject_.style.display="block",this.getMetrics_()):(this.setMetrics_({x:0,y:0}),this.foreignObject_.style.display="none")}};c.ScrollbarNative.prototype.onScroll_=function(){var c={};this.horizontal_?c.x=this.outerDiv_.scrollLeft/this.innerImg_.offsetWidth||0:c.y=this.outerDiv_.scrollTop/this.innerImg_.offsetHeight||0;this.setMetrics_(c)};c.ScrollbarNative.prototype.set=
function(d,e){if(!e)var f=c.unbindEvent_(this.onScrollWrapper_);this.horizontal_?this.outerDiv_.scrollLeft=d*this.ratio_:this.outerDiv_.scrollTop=d*this.ratio_;e||(this.onScrollWrapper_=c.bindEvent_(this.outerDiv_,"scroll",this,f))};c.ScrollbarNative.scrollbarThickness=0;c.ScrollbarNative.measureScrollbarThickness_=function(d){var e=new c.ScrollbarNative(d,null,null,null,!1);e.outerDiv_.style.width="100px";e.outerDiv_.style.height="100px";e.innerImg_.style.width="100%";e.innerImg_.style.height="200px";
e.foreignObject_.setAttribute("width",1);e.foreignObject_.setAttribute("height",1);e.outerDiv_.style.overflowY="scroll";var f=e.innerImg_.offsetWidth;e.outerDiv_.style.overflowY="hidden";var g=e.innerImg_.offsetWidth;d.parentNode.removeChild(e.foreignObject_);d=g-f;0>=d&&(d=15);c.ScrollbarNative.scrollbarThickness=d};c.ScrollbarSvg=function(d,e,f,g,l){this.element_=d;this.getMetrics_=e;this.setMetrics_=f;this.pair_=l||!1;this.horizontal_=g;this.createDom_(d);g?(this.svgBackground_.setAttribute("height",
c.ScrollbarSvg.scrollbarThickness),this.svgKnob_.setAttribute("height",c.ScrollbarSvg.scrollbarThickness-6),this.svgKnob_.setAttribute("y",3)):(this.svgBackground_.setAttribute("width",c.ScrollbarSvg.scrollbarThickness),this.svgKnob_.setAttribute("width",c.ScrollbarSvg.scrollbarThickness-6),this.svgKnob_.setAttribute("x",3));var m=this;this.pair_||(this.resize(),this.onResizeWrapper_=c.bindEvent_(window,"resize",m,function(){m.resize()}));this.onMouseDownBarWrapper_=c.bindEvent_(this.svgBackground_,
"mousedown",m,m.onMouseDownBar_);this.onMouseDownKnobWrapper_=c.bindEvent_(this.svgKnob_,"mousedown",m,m.onMouseDownKnob_)};c.ScrollbarSvg.prototype.destroy=function(){this.onMouseUpKnob_();this.onResizeWrapper_&&(c.unbindEvent_(this.onResizeWrapper_),this.onResizeWrapper_=null);c.unbindEvent_(this.onMouseDownBarWrapper_);this.onMouseDownBarWrapper_=null;c.unbindEvent_(this.onMouseDownKnobWrapper_);this.onMouseDownKnobWrapper_=null;this.svgGroup_.parentNode.removeChild(this.svgGroup_);this.setMetrics_=
this.getMetrics_=this.element_=this.svgKnob_=this.svgBackground_=this.svgGroup_=null};c.ScrollbarSvg.prototype.resize=function(d){if(!d&&(d=this.getMetrics_(),!d))return;if(this.horizontal_){var e=d.viewWidth;this.pair_?e-=c.ScrollbarSvg.scrollbarThickness:this.setVisible(e<d.contentHeight);this.ratio_=e/d.contentWidth;if(-Infinity===this.ratio_||Infinity===this.ratio_||isNaN(this.ratio_))this.ratio_=0;var f=d.viewWidth*this.ratio_,g=(d.viewLeft-d.contentLeft)*this.ratio_;this.svgKnob_.setAttribute("width",
Math.max(0,f));this.xCoordinate=d.absoluteLeft;this.pair_&&c.RTL&&(this.xCoordinate+=d.absoluteLeft+c.ScrollbarSvg.scrollbarThickness);this.yCoordinate=d.absoluteTop+d.viewHeight-c.ScrollbarSvg.scrollbarThickness;this.svgGroup_.setAttribute("transform","translate("+this.xCoordinate+", "+this.yCoordinate+")");this.svgBackground_.setAttribute("width",Math.max(0,e));this.svgKnob_.setAttribute("x",this.constrainKnob_(g))}else{e=d.viewHeight;this.pair_?e-=c.ScrollbarSvg.scrollbarThickness:this.setVisible(e<
d.contentHeight);this.ratio_=e/d.contentHeight;if(-Infinity===this.ratio_||Infinity===this.ratio_||isNaN(this.ratio_))this.ratio_=0;f=d.viewHeight*this.ratio_;g=(d.viewTop-d.contentTop)*this.ratio_;this.svgKnob_.setAttribute("height",Math.max(0,f));this.xCoordinate=d.absoluteLeft;c.RTL||(this.xCoordinate+=d.viewWidth-c.ScrollbarSvg.scrollbarThickness);this.yCoordinate=d.absoluteTop;this.svgGroup_.setAttribute("transform","translate("+this.xCoordinate+", "+this.yCoordinate+")");this.svgBackground_.setAttribute("height",
Math.max(0,e));this.svgKnob_.setAttribute("y",this.constrainKnob_(g))}this.onScroll_()};c.ScrollbarSvg.prototype.createDom_=function(d){this.svgGroup_=c.createSvgElement("g",{},null);this.svgBackground_=c.createSvgElement("rect",{"class":"blocklyScrollbarBackground"},this.svgGroup_);var e=Math.floor((c.ScrollbarSvg.scrollbarThickness-6)/2);this.svgKnob_=c.createSvgElement("rect",{"class":"blocklyScrollbarKnob",rx:e,ry:e},this.svgGroup_);c.Scrollbar.insertAfter_(this.svgGroup_,d)};c.ScrollbarSvg.prototype.isVisible=
function(){return"none"!=this.svgGroup_.getAttribute("display")};c.ScrollbarSvg.prototype.setVisible=function(c){if(c!=this.isVisible()){if(this.pair_)throw"Unable to toggle visibility of paired scrollbars.";c?this.svgGroup_.setAttribute("display","block"):(this.setMetrics_({x:0,y:0}),this.svgGroup_.setAttribute("display","none"))}};c.ScrollbarSvg.prototype.onMouseDownBar_=function(d){c.hideChaff(!0);if(!c.isRightButton(d)){c.svgResize();var e=c.svgSize(),e=this.horizontal_?d.x-e.left:d.y-e.top,f=
c.getAbsoluteXY_(this.svgKnob_),f=this.horizontal_?f.x:f.y,g=parseFloat(this.svgKnob_.getAttribute(this.horizontal_?"width":"height")),l=parseFloat(this.svgKnob_.getAttribute(this.horizontal_?"x":"y")),m=0.95*g;e<=f?l-=m:e>=f+g&&(l+=m);this.svgKnob_.setAttribute(this.horizontal_?"x":"y",this.constrainKnob_(l));this.onScroll_()}d.stopPropagation()};c.ScrollbarSvg.prototype.onMouseDownKnob_=function(d){c.hideChaff(!0);this.onMouseUpKnob_();c.isRightButton(d)||(this.startDragKnob=parseFloat(this.svgKnob_.getAttribute(this.horizontal_?
"x":"y")),this.startDragMouse=this.horizontal_?d.clientX:d.clientY,c.ScrollbarSvg.onMouseUpWrapper_=c.bindEvent_(c.svgDoc,"mouseup",this,this.onMouseUpKnob_),c.ScrollbarSvg.onMouseMoveWrapper_=c.bindEvent_(c.svgDoc,"mousemove",this,this.onMouseMoveKnob_));d.stopPropagation()};c.ScrollbarSvg.prototype.onMouseMoveKnob_=function(c){this.svgKnob_.setAttribute(this.horizontal_?"x":"y",this.constrainKnob_(this.startDragKnob+((this.horizontal_?c.clientX:c.clientY)-this.startDragMouse)));this.onScroll_()};
c.ScrollbarSvg.prototype.onMouseUpKnob_=function(){c.ScrollbarSvg.onMouseUpWrapper_&&(c.unbindEvent_(c.ScrollbarSvg.onMouseUpWrapper_),c.ScrollbarSvg.onMouseUpWrapper_=null);c.ScrollbarSvg.onMouseMoveWrapper_&&(c.unbindEvent_(c.ScrollbarSvg.onMouseMoveWrapper_),c.ScrollbarSvg.onMouseMoveWrapper_=null)};c.ScrollbarSvg.prototype.constrainKnob_=function(c){if(0>=c||isNaN(c))c=0;else var d=this.horizontal_?"width":"height",e=parseFloat(this.svgBackground_.getAttribute(d)),d=parseFloat(this.svgKnob_.getAttribute(d)),
c=Math.min(c,e-d);return c};c.ScrollbarSvg.prototype.onScroll_=function(){var c=parseFloat(this.svgKnob_.getAttribute(this.horizontal_?"x":"y")),d=parseFloat(this.svgBackground_.getAttribute(this.horizontal_?"width":"height")),c=c/d;isNaN(c)&&(c=0);d={};this.horizontal_?d.x=c:d.y=c;this.setMetrics_(d)};c.ScrollbarSvg.prototype.set=function(c,d){this.svgKnob_.setAttribute(this.horizontal_?"x":"y",c*this.ratio_);if(d)this.onScroll_()};c.ScrollbarSvg.scrollbarThickness=15;c.Scrollbar={};var d=!1,e=-1!=
window.navigator.userAgent.indexOf("Gecko/"),f="MacIntel"==window.navigator.platform,g=-1!=window.navigator.platform.indexOf("Linux");if(e&&(f||g))d=!0;c.Scrollbar=d?c.ScrollbarNative:c.ScrollbarSvg;c.Scrollbar.insertAfter_=function(c,d){var e=d.nextSibling,f=d.parentNode;if(!f)throw"Reference node has no parent.";e?f.insertBefore(c,e):f.appendChild(c)}}).call(this,Blockly);(function(c){c.Toolbox={};c.Toolbox.width=0;c.Toolbox.selectedOption_=null;c.Toolbox.createDom=function(){c.Toolbox.flyout_=new c.Flyout;var d=c.createSvgElement("g",{},null);c.Toolbox.svgGroup_=d;var e=c.Toolbox.flyout_.createDom();d.appendChild(e);c.Toolbox.svgBackground_=c.createSvgElement("rect",{"class":"blocklyToolboxBackground",height:"100%"},d);c.Toolbox.svgOptions_=c.createSvgElement("g",{"class":"blocklyToolboxOptions"},d);return d};c.Toolbox.getMetrics=function(){var d=c.svgSize().height,
e=c.Toolbox.width;try{var f=c.Toolbox.svgOptions_.getBBox()}catch(g){return null}return{viewHeight:d,viewWidth:e,contentHeight:f.height+f.y,viewTop:-c.Toolbox.svgOptions_.scrollY,contentTop:0,absoluteTop:0,absoluteLeft:c.RTL?-1:1}};c.Toolbox.setMetrics=function(d){var e=c.Toolbox.getMetrics();"number"==typeof d.y&&(c.Toolbox.svgOptions_.scrollY=-e.contentHeight*d.y-e.contentTop);c.Toolbox.svgOptions_.setAttribute("transform","translate(0,"+(c.Toolbox.svgOptions_.scrollY+e.absoluteTop)+")")};c.Toolbox.init=
function(){c.Toolbox.flyout_.init(c.mainWorkspace,c.getMainWorkspaceMetrics,!0);c.Toolbox.languageTree=c.Toolbox.buildTree_();c.Toolbox.redraw();new c.Scrollbar(c.Toolbox.svgOptions_,c.Toolbox.getMetrics,c.Toolbox.setMetrics,!1,!1);c.Toolbox.position_();c.bindEvent_(window,"resize",null,c.Toolbox.position_)};c.Toolbox.position_=function(){var d=c.svgSize();c.RTL&&c.Toolbox.svgGroup_.setAttribute("transform","translate("+(d.width-c.Toolbox.width)+",0)")};c.Toolbox.PREFIX_="cat_";c.Toolbox.buildTree_=
function(){var d={},e;for(e in c.Language){var f=c.Language[e];f.category&&(f=c.Toolbox.PREFIX_+window.encodeURI(f.category),f in d?d[f].push(e):d[f]=[e])}return d};c.Toolbox.redraw=function(){function d(d){return function(e){var f=c.Toolbox.selectedOption_;c.hideChaff();f==d?c.Toolbox.clearSelection():c.Toolbox.selectOption_(d);e.stopPropagation()}}var e=[],f;for(f in c.Toolbox.languageTree){var g={};g.text=window.decodeURI(f.substring(c.Toolbox.PREFIX_.length));g.cat=f;e.push(g)}g={};(c.Language.variables_get||
c.Language.variables_set)&&e.push({text:c.MSG_VARIABLE_CATEGORY,cat:c.MSG_VARIABLE_CATEGORY});(c.Language.procedures_defnoreturn||c.Language.procedures_defreturn)&&e.push({text:c.MSG_PROCEDURE_CATEGORY,cat:c.MSG_PROCEDURE_CATEGORY});c.removeChildren_(c.Toolbox.svgOptions_);f=0;for(var h=[c.Toolbox.svgBackground_],i=0;g=e[i];i++){var k=c.ContextMenu.optionToDom(g.text),j=k.firstChild,l=k.lastChild;c.Toolbox.svgOptions_.appendChild(k);k.setAttribute("transform","translate(0, "+(i*c.ContextMenu.Y_HEIGHT+
4)+")");k.cat=g.cat;c.bindEvent_(k,"mousedown",null,d(k));h.push(j);f=Math.max(f,l.getComputedTextLength())}f+=2*c.ContextMenu.X_PADDING;for(i=0;i<h.length;i++)h[i].setAttribute("width",f);if(c.RTL)for(i=0;k=c.Toolbox.svgOptions_.childNodes[i];i++)l=k.lastChild,l.setAttribute("text-anchor","end"),l.setAttribute("x",f-c.ContextMenu.X_PADDING);c.Toolbox.width=f;c.bindEvent_(c.Toolbox.svgGroup_,"mousedown",null,function(d){c.isRightButton(d)&&(c.hideChaff(!0),d.stopPropagation())});c.fireUiEvent(window,
"resize")};c.Toolbox.selectOption_=function(d){c.Toolbox.clearSelection();if(c.Toolbox.selectedOption_=d)c.addClass_(d,"blocklyMenuSelected"),d=d.cat,c.Toolbox.flyout_.show(c.Toolbox.languageTree[d]||d)};c.Toolbox.clearSelection=function(){var d=c.Toolbox.selectedOption_;d&&(c.removeClass_(d,"blocklyMenuSelected"),c.Toolbox.selectedOption_=null);c.Toolbox.flyout_.hide()}}).call(this,Blockly);(function(c){c.Tooltip={};c.Tooltip.mouseOutPid=0;c.Tooltip.showPid=0;c.Tooltip.lastX=0;c.Tooltip.lastY=0;c.Tooltip.visible=!1;c.Tooltip.element=null;c.Tooltip.poisonedElement=null;c.Tooltip.svgGroup_=null;c.Tooltip.svgText_=null;c.Tooltip.svgBackground_=null;c.Tooltip.svgShadow_=null;c.Tooltip.OFFSET_X=0;c.Tooltip.OFFSET_Y=10;c.Tooltip.RADIUS_OK=10;c.Tooltip.HOVER_MS=1E3;c.Tooltip.MARGINS=5;c.Tooltip.createDom=function(){var d=c.createSvgElement("g",{"class":"blocklyHidden"},null);c.Tooltip.svgGroup_=
d;c.Tooltip.svgShadow_=c.createSvgElement("rect",{"class":"blocklyTooltipShadow",x:2,y:2},d);c.Tooltip.svgBackground_=c.createSvgElement("rect",{"class":"blocklyTooltipBackground"},d);c.Tooltip.svgText_=c.createSvgElement("text",{"class":"blocklyTooltipText"},d);return d};c.Tooltip.bindMouseEvents=function(d){c.bindEvent_(d,"mouseover",null,c.Tooltip.onMouseOver_);c.bindEvent_(d,"mouseout",null,c.Tooltip.onMouseOut_);c.bindEvent_(d,"mousemove",null,c.Tooltip.onMouseMove_)};c.Tooltip.onMouseOver_=
function(d){for(d=d.target;"object"==typeof d.tooltip;)d=d.tooltip;c.Tooltip.element!=d&&(c.Tooltip.hide(),c.Tooltip.poisonedElement=null,c.Tooltip.element=d);window.clearTimeout(c.Tooltip.mouseOutPid)};c.Tooltip.onMouseOut_=function(){c.Tooltip.mouseOutPid=window.setTimeout(function(){c.Tooltip.element=null;c.Tooltip.poisonedElement=null;c.Tooltip.hide()},1);window.clearTimeout(c.Tooltip.showPid)};c.Tooltip.onMouseMove_=function(d){if(c.Tooltip.element&&c.Tooltip.element.tooltip&&!(c.ContextMenu&&
c.ContextMenu.visible||0!=c.Block.dragMode_))if(c.Tooltip.visible){var e=c.Tooltip.lastY-d.clientY;Math.sqrt(Math.pow(c.Tooltip.lastX-d.clientX,2)+Math.pow(e,2))>c.Tooltip.RADIUS_OK&&c.Tooltip.hide()}else c.Tooltip.poisonedElement!=c.Tooltip.element&&(window.clearTimeout(c.Tooltip.showPid),c.Tooltip.lastX=d.clientX,c.Tooltip.lastY=d.clientY,c.Tooltip.showPid=window.setTimeout(c.Tooltip.show_,c.Tooltip.HOVER_MS))};c.Tooltip.hide=function(){c.Tooltip.visible&&(c.Tooltip.visible=!1,c.Tooltip.svgGroup_&&
(c.Tooltip.svgGroup_.style.display="none"));window.clearTimeout(c.Tooltip.showPid)};c.Tooltip.show_=function(){c.Tooltip.poisonedElement=c.Tooltip.element;if(c.Tooltip.svgGroup_){c.removeChildren_(c.Tooltip.svgText_);var d=c.Tooltip.element.tooltip;"function"==typeof d&&(d=d());for(var d=d.split("\n"),e=0;e<d.length;e++){var f=c.createSvgElement("tspan",{dy:"1em",x:c.Tooltip.MARGINS},c.Tooltip.svgText_),g=c.svgDoc.createTextNode(d[e]);f.appendChild(g)}c.Tooltip.visible=!0;c.Tooltip.svgGroup_.style.display=
"block";d=c.Tooltip.svgText_.getBBox();e=2*c.Tooltip.MARGINS+d.width;f=d.height;c.Tooltip.svgBackground_.setAttribute("width",e);c.Tooltip.svgBackground_.setAttribute("height",f);c.Tooltip.svgShadow_.setAttribute("width",e);c.Tooltip.svgShadow_.setAttribute("height",f);if(c.RTL)for(var f=d.width,g=0,h;h=c.Tooltip.svgText_.childNodes[g];g++)h.setAttribute("text-anchor","end"),h.setAttribute("x",f+c.Tooltip.MARGINS);f=c.Tooltip.lastX;f=c.RTL?f-(c.Tooltip.OFFSET_X+e):f+c.Tooltip.OFFSET_X;e=c.Tooltip.lastY+
c.Tooltip.OFFSET_Y;e=c.mouseToSvg(f,e);f=e.x;e=e.y;g=c.svgSize();e+d.height>g.height&&(e-=d.height+2*c.Tooltip.OFFSET_Y);c.RTL?f=Math.max(c.Tooltip.MARGINS,f):f+d.width>g.width-2*c.Tooltip.MARGINS&&(f=g.width-d.width-2*c.Tooltip.MARGINS);c.Tooltip.svgGroup_.setAttribute("transform","translate("+f+","+e+")")}}}).call(this,Blockly);(function(c){c.Trashcan=function(c){this.getMetrics_=c};c.Trashcan.prototype.BODY_URL_="media/trashbody.png";c.Trashcan.prototype.LID_URL_="media/trashlid.png";c.Trashcan.prototype.WIDTH_=47;c.Trashcan.prototype.BODY_HEIGHT_=45;c.Trashcan.prototype.LID_HEIGHT_=15;c.Trashcan.prototype.MARGIN_BOTTOM_=35;c.Trashcan.prototype.MARGIN_SIDE_=35;c.Trashcan.prototype.isOpen=!1;c.Trashcan.prototype.svgGroup_=null;c.Trashcan.prototype.svgBody_=null;c.Trashcan.prototype.svgLid_=null;c.Trashcan.prototype.lidTask_=
0;c.Trashcan.prototype.lidAngle_=0;c.Trashcan.prototype.left_=0;c.Trashcan.prototype.top_=0;c.Trashcan.prototype.createDom=function(){this.svgGroup_=c.createSvgElement("g",{filter:"url(#blocklyTrashcanShadowFilter)"},null);this.svgBody_=c.createSvgElement("image",{width:this.WIDTH_,height:this.BODY_HEIGHT_},this.svgGroup_);this.svgBody_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c.pathToBlockly+this.BODY_URL_);this.svgBody_.setAttribute("y",this.LID_HEIGHT_);this.svgLid_=c.createSvgElement("image",
{width:this.WIDTH_,height:this.LID_HEIGHT_},this.svgGroup_);this.svgLid_.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c.pathToBlockly+this.LID_URL_);return this.svgGroup_};c.Trashcan.prototype.init=function(){this.setOpen_(!1);this.position_();c.bindEvent_(window,"resize",this,this.position_)};c.Trashcan.prototype.destroy=function(){this.svgGroup_&&(this.svgGroup_.parentNode.removeChild(this.svgGroup_),this.svgGroup_=null);this.getMetrics_=this.svgLid_=this.svgBody_=null;window.clearTimeout(this.lidTask_)};
c.Trashcan.prototype.position_=function(){var d=this.getMetrics_();d&&(this.left_=c.RTL?this.MARGIN_SIDE_:d.viewWidth+d.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_,this.top_=d.viewHeight+d.absoluteTop-(this.BODY_HEIGHT_+this.LID_HEIGHT_)-this.MARGIN_BOTTOM_,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))};c.Trashcan.prototype.onMouseMove=function(d){if(this.svgGroup_){var e=c.getAbsoluteXY_(this.svgGroup_),f=e.x,g=e.y,e=c.mouseToSvg(d.clientX,d.clientY),d=e.x,e=
e.y,f=d>f&&d<f+this.WIDTH_&&e>g&&e<g+this.BODY_HEIGHT_+this.LID_HEIGHT_;this.isOpen!=f&&this.setOpen_(f)}};c.Trashcan.prototype.setOpen_=function(d){this.isOpen!=d&&(window.clearTimeout(this.lidTask_),this.isOpen=d,c.Trashcan.animateLid_(this))};c.Trashcan.animateLid_=function(d){d.lidAngle_+=d.isOpen?10:-10;d.lidAngle_=Math.max(0,d.lidAngle_);d.svgLid_.setAttribute("transform","rotate("+(c.RTL?-d.lidAngle_:d.lidAngle_)+", "+(c.RTL?4:d.WIDTH_-4)+", "+(d.LID_HEIGHT_-2)+")");if(d.isOpen?45>d.lidAngle_:
0<d.lidAngle_)d.lidTask_=window.setTimeout(function(){c.Trashcan.animateLid_(d)},5)};c.Trashcan.close=function(c){c.setOpen_(!1)}}).call(this,Blockly);(function(c){c.removeChildren_=function(c){for(var e;e=c.firstChild;)c.removeChild(e)};c.addClass_=function(c,e){var f=c.getAttribute("class")||"";-1==(" "+f+" ").indexOf(" "+e+" ")&&(f&&(f+=" "),c.setAttribute("class",f+e))};c.removeClass_=function(c,e){var f=c.getAttribute("class");if(-1!=(" "+f+" ").indexOf(" "+e+" ")){for(var f=f.split(/\s+/),g=0;g<f.length;g++)if(!f[g]||f[g]==e)f.splice(g,1),g--;f.length?c.setAttribute("class",f.join(" ")):c.removeAttribute("class")}};c.bindEvent_=function(d,
e,f,g){var h=[],i;if(d.addEventListener)i=function(c){g.apply(f,arguments)},d.addEventListener(e,i,!1),h.push([d,e,i]),e in c.bindEvent_.TOUCH_MAP&&(i=function(c){if(1==c.changedTouches.length){var d=c.changedTouches[0];c.clientX=d.clientX;c.clientY=d.clientY}g.apply(f,arguments);c.preventDefault()},d.addEventListener(c.bindEvent_.TOUCH_MAP[e],i,!1),h.push([d,c.bindEvent_.TOUCH_MAP[e],i]));else if(d.attachEvent)i=function(c){g.apply(f,arguments);c.stopPropagation()},d.attachEvent("on"+e,i),h.push([d,
e,i]);else throw"Element is not a DOM node.";return h};c.bindEvent_.TOUCH_MAP="ontouchstart"in document.documentElement?{mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"}:{};c.unbindEvent_=function(c){for(;c.length;){var e=c.pop(),f=e[0],g=e[1],e=e[2];f.removeEventListener?f.removeEventListener(g,e,!1):f.detachEvent("on"+g,e)}return e};c.fireUiEvent=function(d,e){var f=c.svgDoc;if(f.createEvent)f=f.createEvent("UIEvents"),f.initEvent(e,!0,!0),d.dispatchEvent(f);else if(f.createEventObject)f=
f.createEventObject(),d.fireEvent("on"+e,f);else throw"FireEvent: No event creation mechanism.";};c.noEvent=function(c){c.preventDefault();c.stopPropagation()};c.getRelativeXY_=function(c){var e={x:0,y:0},f=c.getAttribute("x");f&&(e.x=parseInt(f,10));if(f=c.getAttribute("y"))e.y=parseInt(f,10);if(c=(c=c.getAttribute("transform"))&&c.match(/translate\(\s*([-\d.]+)(,\s*([-\d.]+)\s*\))?/))e.x+=parseInt(c[1],10),c[3]&&(e.y+=parseInt(c[3],10));return e};c.getAbsoluteXY_=function(d){var e=0,f=0;do var g=
c.getRelativeXY_(d),e=e+g.x,f=f+g.y,d=d.parentNode;while(d&&d!=c.svgDoc);return{x:e,y:f}};c.createSvgElement=function(d,e,f){var d=c.svgDoc.createElementNS(c.SVG_NS,d),g;for(g in e)d.setAttribute(g,e[g]);f&&f.appendChild(d);return d};c.caseInsensitiveComparator=function(c,e){c=c.toLowerCase();e=e.toLowerCase();return c>e?1:c<e?-1:0};c.uniqueId=function(){for(var d="abcdefghijklmnopqrstuvwxyz",e=d.charAt(Math.random()*d.length),d=d+"0123456789-_:.",f=1;8>f;f++)e+=d.charAt(Math.random()*d.length);-1!=
e.indexOf("--")&&(e=c.uniqueId());return e};c.isRightButton=function(c){return 2==c.button||c.ctrlKey};c.mouseToSvg=function(d,e){var f=c.svg.createSVGPoint();f.x=d;f.y=e;var g=c.svg.getScreenCTM().inverse();return f.matrixTransform(g)}}).call(this,Blockly);(function(c){c.Variables={};c.Variables.NAME_TYPE="variable";c.Variables.allVariables=function(d){var e;e=d?d.getDescendants():c.mainWorkspace.getAllBlocks();for(var d={},f=0;f<e.length;f++){var g=e[f].getVars;if(g)for(var g=g.call(e[f]),h=0;h<g.length;h++){var i=g[h];i&&(d[c.Names.PREFIX_+i.toLowerCase()]=i)}}e=[];for(var k in d)e.push(d[k]);return e};c.Variables.renameVariable=function(d,e){for(var f=c.mainWorkspace.getAllBlocks(),g=0;g<f.length;g++){var h=f[g].renameVar;h&&h.call(f[g],d,e)}};c.Variables.flyoutCategory=
function(d,e,f,g){var h=c.Variables.allVariables();h.sort(c.caseInsensitiveComparator);h.unshift(null);for(var i=void 0,k=0;k<h.length;k++)if(h[k]!==i){var j=c.Language.variables_get?new c.Block(g,"variables_get"):null;j&&j.initSvg();var l=c.Language.variables_set?new c.Block(g,"variables_set"):null;l&&l.initSvg();null===h[k]?i=(j||l).getVars()[0]:(j&&j.setTitleValue(h[k],"VAR"),l&&l.setTitleValue(h[k],"VAR"));l&&d.push(l);j&&d.push(j);j&&l?e.push(f,3*f):e.push(2*f)}};c.Variables.refreshFlyoutCategory=
function(){c.Toolbox&&(c.Toolbox.flyout_.isVisible()&&c.Toolbox.selectedOption_.cat==c.MSG_VARIABLE_CATEGORY)&&(c.Toolbox.flyout_.hide(),c.Toolbox.flyout_.show(c.MSG_VARIABLE_CATEGORY))};c.Variables.generateUniqueName=function(){var d=c.Variables.allVariables(),e="";if(d.length){d.sort(c.caseInsensitiveComparator);for(var f=0,g="i",h=0,i=!1;!e;){h=0;for(i=!1;h<d.length&&!i;)d[h].toLowerCase()==g&&(i=!0),h++;i?("z"===g.charAt(0)?(f++,g="a"):(g=String.fromCharCode(g.charCodeAt(0)+1),"l"==g.charAt(0)&&
(g=String.fromCharCode(g.charCodeAt(0)+1))),0<f&&(g+=f)):e=g}}else e="i";return e}}).call(this,Blockly);(function(c){c.Warning=function(c){this.block_=c;this.createIcon_()};c.Warning.ICON_RADIUS=8;c.Warning.prototype.bubble_=null;c.Warning.prototype.text_="";c.Warning.prototype.iconX_=null;c.Warning.prototype.iconY_=null;c.Warning.prototype.relativeLeft_=-100;c.Warning.prototype.relativeTop_=-120;c.Warning.prototype.createIcon_=function(){this.iconGroup_=c.createSvgElement("g",{"class":"blocklyIconGroup"},null);c.createSvgElement("path",{"class":"blocklyIconShield",d:"M 2,15 Q -1,15 0.5,12 L 6.5,1.7 Q 8,-1 9.5,1.7 L 15.5,12 Q 17,15 14,15 z"},
this.iconGroup_);this.iconMark_=c.createSvgElement("text",{"class":"blocklyIconMark",x:c.Warning.ICON_RADIUS/2+2,y:2*c.Warning.ICON_RADIUS-3},this.iconGroup_);this.iconMark_.appendChild(c.svgDoc.createTextNode("!"));this.block_.getSvgRoot().appendChild(this.iconGroup_);c.bindEvent_(this.iconGroup_,"mouseup",this,this.iconClick_)};c.Warning.prototype.textToDom_=function(d){for(var e=c.createSvgElement("text",{"class":"blocklyText",y:c.Bubble.BORDER_WIDTH},null),d=d.split("\n"),f=0;f<d.length;f++){var g=
c.createSvgElement("tspan",{dy:"1em",x:c.Bubble.BORDER_WIDTH},e),h=c.svgDoc.createTextNode(d[f]);g.appendChild(h)}return e};c.Warning.prototype.isVisible=function(){return!!this.bubble_};c.Warning.prototype.setVisible=function(d){if(d!=this.isVisible())if(d){d=this.textToDom_(this.text_);this.bubble_=new c.Bubble(this.block_.workspace.getBubbleCanvas(),d,this.iconX_,this.iconY_,this.relativeLeft_,this.relativeTop_,null,null);if(c.RTL)for(var e=d.getBBox().width,f=0,g;g=d.childNodes[f];f++)g.setAttribute("text-anchor",
"end"),g.setAttribute("x",e+c.Bubble.BORDER_WIDTH);this.updateColour()}else this.bubble_.destroy(),this.foreignObject_=this.body_=this.bubble_=null};c.Warning.prototype.iconClick_=function(){this.setVisible(!this.isVisible())};c.Warning.prototype.bodyFocus_=function(){this.bubble_.promote_()};c.Warning.prototype.setBubbleLocation=function(c,e){this.isVisible()?this.bubble_.setBubbleLocation(c,e):(this.relativeLeft_=c,this.relativeTop_=e)};c.Warning.prototype.setText=function(c){this.text_=c;this.isVisible()&&
(this.setVisible(!1),this.setVisible(!0))};c.Warning.prototype.updateColour=function(){if(this.isVisible()){var d=c.makeColour(this.block_.getColour());this.bubble_.setColour(d)}};c.Warning.prototype.destroy=function(){this.iconGroup_.parentNode.removeChild(this.iconGroup_);this.iconGroup_=null;this.setVisible(!1);this.block_=this.block_.warning=null};c.Warning.prototype.renderIcon=function(d){if(this.block_.collapsed)return this.iconGroup_.setAttribute("display","none"),d;this.iconGroup_.setAttribute("display",
"block");var e=2*c.Warning.ICON_RADIUS;c.RTL&&(d-=e);this.iconGroup_.setAttribute("transform","translate("+d+", 5)");this.computeIconLocation();return d=c.RTL?d-c.BlockSvg.SEP_SPACE_X:d+(e+c.BlockSvg.SEP_SPACE_X)};c.Warning.prototype.setIconLocation=function(c,e){this.iconX_=c;this.iconY_=e;this.isVisible()&&this.bubble_.setAnchorLocation(c,e)};c.Warning.prototype.computeIconLocation=function(){var d=this.block_.getRelativeToSurfaceXY(),e=c.getRelativeXY_(this.iconGroup_),f=d.x+e.x+c.Warning.ICON_RADIUS,
d=d.y+e.y+c.Warning.ICON_RADIUS;(f!==this.iconX_||d!==this.iconY_)&&this.setIconLocation(f,d)};c.Warning.prototype.getIconLocation=function(){return{x:this.iconX_,y:this.iconY_}}}).call(this,Blockly);(function(c){c.Workspace=function(d){this.editable=d;this.topBlocks_=[];c.ConnectionDB.init(this)};c.Workspace.prototype.dragMode=!1;c.Workspace.prototype.scrollX=0;c.Workspace.prototype.scrollY=0;c.Workspace.prototype.trashcan=null;c.Workspace.prototype.fireChangeEventPid_=null;c.Workspace.prototype.createDom=function(){this.svgGroup_=c.createSvgElement("g",{},null);this.svgBlockCanvas_=c.createSvgElement("g",{},this.svgGroup_);this.svgBubbleCanvas_=c.createSvgElement("g",{},this.svgGroup_);this.fireChangeEvent();
return this.svgGroup_};c.Workspace.prototype.destroy=function(){this.svgGroup_&&(this.svgGroup_.parentNode.removeChild(this.svgGroup_),this.svgGroup_=null);this.svgBubbleCanvas_=this.svgBlockCanvas_=null;this.trashcan&&(this.trashcan.destroy(),this.trashcan=null)};c.Workspace.prototype.addTrashcan=function(d){c.Trashcan&&this.editable&&(this.trashcan=new c.Trashcan(d),d=this.trashcan.createDom(),this.svgGroup_.insertBefore(d,this.svgBlockCanvas_),this.trashcan.init())};c.Workspace.prototype.getCanvas=
function(){return this.svgBlockCanvas_};c.Workspace.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_};c.Workspace.prototype.addTopBlock=function(c){this.topBlocks_.push(c);this.fireChangeEvent()};c.Workspace.prototype.removeTopBlock=function(c){for(var e=!1,f,g=0;f=this.topBlocks_[g];g++)if(f==c){this.topBlocks_.splice(g,1);e=!0;break}if(!e)throw"Block not present in workspace's list of top-most blocks.";this.fireChangeEvent()};c.Workspace.prototype.getTopBlocks=function(c){var e=
[].concat(this.topBlocks_);c&&1<e.length&&e.sort(function(c,d){return c.getRelativeToSurfaceXY().y-d.getRelativeToSurfaceXY().y});return e};c.Workspace.prototype.getAllBlocks=function(){for(var c=this.getTopBlocks(!1),e=0;e<c.length;e++)c=c.concat(c[e].getChildren());return c};c.Workspace.prototype.clear=function(){for(c.hideChaff();this.topBlocks_.length;)this.topBlocks_[0].destroy()};c.Workspace.prototype.render=function(){for(var c=this.getAllBlocks(),e=0,f;f=c[e];e++)f.getChildren().length||f.render()};
c.Workspace.prototype.getBlockById=function(c){for(var e=this.getAllBlocks(),f=0,g;g=e[f];f++)if(g.id==c)return g;return null};c.Workspace.prototype.traceOn=function(d){this.traceOn_=d;this.traceWrapper_&&(c.unbindEvent_(this.traceWrapper_),this.traceWrapper_=null);d&&(this.traceWrapper_=c.bindEvent_(this.svgBlockCanvas_,"blocklySelectChange",this,function(){this.traceOn_=!1}))};c.Workspace.prototype.highlightBlock=function(c){if(this.traceOn_&&(c=this.getBlockById(c)))this.traceOn(!1),c.select(),
this.traceOn(!0)};c.Workspace.prototype.fireChangeEvent=function(){this.fireChangeEventPid_&&window.clearTimeout(this.fireChangeEventPid_);var d=this.svgBlockCanvas_;d&&(this.fireChangeEventPid_=window.setTimeout(function(){c.fireUiEvent(d,"blocklyWorkspaceChange")},0))};c.Workspace.prototype.paste=function(d){var e=c.Xml.domToBlock_(this,d),f=parseInt(d.getAttribute("x"),10),d=parseInt(d.getAttribute("y"),10);if(!isNaN(f)&&!isNaN(d)){c.RTL&&(f=-f);do for(var g=!1,h=this.getAllBlocks(),i=0,k;k=h[i];i++)k=
k.getRelativeToSurfaceXY(),1>=Math.abs(f-k.x)&&1>=Math.abs(d-k.y)&&(f=c.RTL?f-c.SNAP_RADIUS:f+c.SNAP_RADIUS,d+=2*c.SNAP_RADIUS,g=!0);while(g);e.moveBy(f,d)}e.select()}}).call(this,Blockly);(function(c){c.Xml={};c.Xml.workspaceToDom=function(d){for(var e=document.createElement("xml"),d=d.getTopBlocks(!1),f=0,g;g=d[f];f++){var h=c.Xml.blockToDom_(g);g=g.getRelativeToSurfaceXY();h.setAttribute("x",c.RTL?-g.x:g.x);h.setAttribute("y",g.y);e.appendChild(h)}return e};c.Xml.blockToDom_=function(d){var e=document.createElement("block");e.setAttribute("type",d.type);if(d.mutationToDom){var f=d.mutationToDom();f&&e.appendChild(f)}for(var g=0;f=d.inputList[g];g++)for(var h=0,i;i=f.titleRow[h];h++){var k=
i;k.name&&k.EDITABLE&&(i=document.createElement("title"),i.setAttribute("name",k.name),k=document.createTextNode(k.getValue()),i.appendChild(k),e.appendChild(i))}d.comment&&(f=document.createElement("comment"),g=document.createTextNode(d.comment.getText()),f.appendChild(g),f.setAttribute("pinned",d.comment.isVisible()),g=d.comment.getBubbleLocation(),f.setAttribute("x",g.x),f.setAttribute("y",g.y),g=d.comment.getBubbleSize(),f.setAttribute("h",g.height),f.setAttribute("w",g.width),e.appendChild(f));
g=!1;for(h=0;f=d.inputList[h];h++){var j;i=!0;f.type!=c.DUMMY_INPUT&&(k=f.connection.targetBlock(),f.type==c.INPUT_VALUE?(j=document.createElement("value"),g=!0):f.type==c.NEXT_STATEMENT&&(j=document.createElement("statement")),k&&(j.appendChild(c.Xml.blockToDom_(k)),i=!1),j.setAttribute("name",f.name),i||e.appendChild(j))}g&&e.setAttribute("inline",d.inputsInline);d.collapsed&&e.setAttribute("collapsed",!0);d.disabled&&e.setAttribute("disabled",!0);if(d.nextConnection&&(d=d.nextConnection.targetBlock()))j=
document.createElement("next"),j.appendChild(c.Xml.blockToDom_(d)),e.appendChild(j);return e};c.Xml.domToText=function(c){return(new XMLSerializer).serializeToString(c)};c.Xml.domToPrettyText=function(d){for(var d=c.Xml.domToText(d).split("<"),e="",f=1;f<d.length;f++){var g=d[f][0];"/"==g&&(e=e.substring(2));d[f]=e+"<"+d[f];"/"!=g&&(e+="  ")}d=d.join("\n");d=d.replace(/(<(\w+)[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>");return d.replace(/^\n/,"")};c.Xml.textToDom=function(c){c=(new DOMParser).parseFromString(c,
"text/xml");if(!c||!c.firstChild||"xml"!=c.firstChild.tagName||c.firstChild!==c.lastChild)throw"Blockly.Xml.textToDom did not obtain a valid XML tree.";return c.firstChild};c.Xml.domToWorkspace=function(d,e){for(var f=0,g;g=e.childNodes[f];f++)if(g.nodeName&&"block"==g.nodeName.toLowerCase()){var h=c.Xml.domToBlock_(d,g),i=parseInt(g.getAttribute("x"),10);g=parseInt(g.getAttribute("y"),10);!isNaN(i)&&!isNaN(g)&&h.moveBy(c.RTL?-i:i,g)}};c.Xml.domToBlock_=function(d,e){var f=e.getAttribute("type"),
f=new c.Block(d,f);f.initSvg();for(var g=null,h=0,i;i=e.childNodes[h];h++)if(!(3==i.nodeType&&i.data.match(/^\s*$/))){for(var k=null,j=0,l;l=i.childNodes[j];j++)if(3!=l.nodeType||!l.data.match(/^\s*$/))k=l;j=i.getAttribute("name");switch(i.tagName.toLowerCase()){case "mutation":f.domToMutation&&f.domToMutation(i);break;case "comment":f.setCommentText(i.textContent);(k=i.getAttribute("pinned"))&&f.comment.setVisible("true"==k);k=parseInt(i.getAttribute("x"),10);j=parseInt(i.getAttribute("y"),10);!isNaN(k)&&
!isNaN(j)&&f.comment.setBubbleLocation(k,j,!1);k=parseInt(i.getAttribute("w"),10);i=parseInt(i.getAttribute("h"),10);!isNaN(k)&&!isNaN(i)&&f.comment.setBubbleSize(k,i);break;case "title":f.setTitleValue(i.textContent,j);break;case "variable":console.log("Obsolete variable tag.  Please regenerate XML.");i=i.getAttribute("data");null!==i&&f.setTitleValue(i,j);break;case "value":case "statement":i=f.getInput(j);if(!i)throw"Input does not exist: "+j;if(k&&k.tagName&&"block"==k.tagName.toLowerCase())if(g=
c.Xml.domToBlock_(d,k),g.outputConnection)i.connection.connect(g.outputConnection);else if(g.previousConnection)i.connection.connect(g.previousConnection);else throw"Child block does not have output or previous statement.";break;case "next":if(k&&k.tagName&&"block"==k.tagName.toLowerCase()){if(f.nextConnection){if(f.nextConnection.targetConnection)throw"Next statement is already connected.";}else throw"Next statement does not exist.";g=c.Xml.domToBlock_(d,k);if(!g.previousConnection)throw"Next block does not have previous statement.";
f.nextConnection.connect(g.previousConnection)}}}(h=e.getAttribute("inline"))&&f.setInputsInline("true"==h);(h=e.getAttribute("collapsed"))&&f.setCollapsed("true"==h);(h=e.getAttribute("disabled"))&&f.setDisabled("true"==h);g||f.render();return f};c.Xml.isFirstRealChild_=function(c,e){for(var f=0,g;g=c.childNodes[f];f++)if(3!=g.nodeType||!g.data.match(/^\s*$/))return g.tagName&&g.tagName.toLowerCase()==e;return!1};c.Xml.deleteNext=function(c){for(var e=0,f;f=c.childNodes[e];e++)if("next"==f.tagName.toLowerCase()){c.removeChild(f);
break}}}).call(this,Blockly);